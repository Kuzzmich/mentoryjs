# 3.2.6 Mapped Types

Mapped Types –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É—è –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ. –≠—Ç–æ –∫–∞–∫ –º–µ—Ç–æ–¥ `.map()` –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤, –Ω–æ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤: –±–µ—Ä—ë—à—å –æ–±—ä–µ–∫—Ç, –ø—Ä–æ—Ö–æ–¥–∏—à—å—Å—è –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á—É –∏ –¥–µ–ª–∞–µ—à—å –∏–∑ –Ω–µ–≥–æ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ.

---

## üéØ –ß—Ç–æ —Ç—ã —É–∑–Ω–∞–µ—à—å

- –°–∏–Ω—Ç–∞–∫—Å–∏—Å `{ [K in keyof T]: ... }` –∏ –∫–∞–∫ –µ–≥–æ —á–∏—Ç–∞—Ç—å
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã `readonly` –∏ `?` –∏ –∫–∞–∫ –∏—Ö –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–±–∏—Ä–∞—Ç—å
- –û–ø–µ—Ä–∞—Ç–æ—Ä `as` –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Mapped Types —Å —É—Å–ª–æ–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
- –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ `Partial`, `Required`, `Readonly`, `Pick`, `Omit`
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤

---

## üìñ –¢–µ–æ—Ä–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ Mapped Types –∏ –∑–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —É —Ç–µ–±—è –µ—Å—Ç—å —Ç–∏–ø `WeatherData` —Å 9 –ø–æ–ª—è–º–∏. –¢–µ–±–µ –Ω—É–∂–Ω–∞ –µ–≥–æ –≤–µ—Ä—Å–∏—è, –≥–¥–µ –≤—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã (–¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è), –∏ –≤–µ—Ä—Å–∏—è, –≥–¥–µ –≤—Å–µ –ø–æ–ª—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (–¥–ª—è –∫—ç—à–∞). –ë–µ–∑ Mapped Types –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø –≤—Ä—É—á–Ω—É—é:

```typescript
// ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —Ö—Ä—É–ø–∫–æ –∏ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ
interface PartialWeatherData {
  city?: string;
  temperature?: number;
  feelsLike?: number;
  // ... 6 –ø–æ–ª–µ–π –µ—â—ë —Ä–∞–∑
}

// ‚úÖ Mapped Type ‚Äî –æ–¥–∏–Ω —Ä–∞–∑, —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ —Ç–∏–ø–∞
type Partial<T> = {
  [K in keyof T]?: T[K];
};

type PartialWeatherData = Partial<WeatherData>; // –ì–æ—Ç–æ–≤–æ!
```

–ö–æ–≥–¥–∞ `WeatherData` –∏–∑–º–µ–Ω–∏—Ç—Å—è ‚Äî `PartialWeatherData` –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## 1. –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```typescript
type MyMappedType<T> = {
  [K in keyof T]: T[K];
};
```

–ß–∏—Ç–∞–µ—Ç—Å—è: ¬´–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ `K` –∏–∑ `T`, –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –∫–ª—é—á–∞ ‚Äî `T[K]`¬ª.

```typescript
interface WeatherData {
  city: string;
  temperature: number;
  humidity: number;
}

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ WeatherData ‚Äî –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç —Ç–∏–ø
type Same<T> = { [K in keyof T]: T[K] };

// –î–µ–ª–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∞–º–∏
type Stringify<T> = { [K in keyof T]: string };
type StringWeather = Stringify<WeatherData>;
// { city: string; temperature: string; humidity: string }
```

---

## 2. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã: `readonly` –∏ `?`

–° –ø–æ–º–æ—â—å—é Mapped Types –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏–ª–∏ —É–±–∏—Ä–∞—Ç—å `readonly` –∏ `?` —É –≤—Å–µ—Ö –ø–æ–ª–µ–π —Å—Ä–∞–∑—É:

```typescript
// –î–æ–±–∞–≤–∏—Ç—å ? ‚Äî –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
type Optional<T> = { [K in keyof T]?: T[K] };

// –£–±—Ä–∞—Ç—å ? ‚Äî –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã (- –æ–∑–Ω–∞—á–∞–µ—Ç "—É–±—Ä–∞—Ç—å")
type Strict<T> = { [K in keyof T]-?: T[K] };

// –î–æ–±–∞–≤–∏—Ç—å readonly ‚Äî –ø–æ–ª—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
type Frozen<T> = { readonly [K in keyof T]: T[K] };

// –£–±—Ä–∞—Ç—å readonly ‚Äî –ø–æ–ª—è —Å–Ω–æ–≤–∞ –∏–∑–º–µ–Ω—è–µ–º—ã
type Mutable<T> = { -readonly [K in keyof T]: T[K] };
```

–≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã TypeScript:

```typescript
// –í–æ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ TypeScript (—É–ø—Ä–æ—â—ë–Ω–Ω–æ):
type Partial<T>  = { [K in keyof T]?: T[K] };
type Required<T> = { [K in keyof T]-?: T[K] };
type Readonly<T> = { readonly [K in keyof T]: T[K] };
```

---

## 3. –û–ø–µ—Ä–∞—Ç–æ—Ä `as`: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

–° TypeScript 4.1+ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—Ç—å –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ `as`:

```typescript
// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–ª—é—á–∏
// (K extends ... ? K : never —É–±–∏—Ä–∞–µ—Ç –∫–ª—é—á –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)
type PickByValue<T, V> = {
  [K in keyof T as T[K] extends V ? K : never]: T[K];
};

// –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è WeatherData
type NumericWeather = PickByValue<WeatherData, number>;
// { temperature: number; feelsLike: number; humidity: number; ... }

// –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è WeatherData
type StringWeather = PickByValue<WeatherData, string>;
// { city: string; country: string; description: string; icon: string }
```

`never` –≤ –ø–æ–∑–∏—Ü–∏–∏ –∫–ª—é—á–∞ –æ–∑–Ω–∞—á–∞–µ—Ç "–≤—ã–±—Ä–æ—Å–∏—Ç—å —ç—Ç–æ—Ç –∫–ª—é—á" ‚Äî TypeScript —É–±–∏—Ä–∞–µ—Ç –µ–≥–æ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

---

## 4. –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã `Pick` –∏ `Omit`

```typescript
// Pick ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏
// K extends keyof T –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ K ‚Äî –∫–ª—é—á–∏ T
type Pick<T, K extends keyof T> = {
  [P in K]: T[P];
};

// Omit ‚Äî —É–±—Ä–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏
// Exclude<keyof T, K> ‚Äî –≤—Å–µ –∫–ª—é—á–∏ T –∫—Ä–æ–º–µ K
type Omit<T, K extends keyof T> = {
  [P in Exclude<keyof T, K>]: T[P];
};

// –ò–ª–∏ —á–µ—Ä–µ–∑ as:
type Omit<T, K extends keyof T> = {
  [P in keyof T as P extends K ? never : P]: T[P];
};
```

---

## 5. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Å–ª–æ–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏

Mapped Types –∏ —É—Å–ª–æ–≤–Ω—ã–µ —Ç–∏–ø—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–º–µ—Å—Ç–µ:

```typescript
// –°–¥–µ–ª–∞—Ç—å –ø–æ–ª—è nullable ‚Äî –¥–æ–±–∞–≤–∏—Ç—å | null –∫ –∫–∞–∂–¥–æ–º—É
type Nullable<T> = { [K in keyof T]: T[K] | null };

type NullableWeather = Nullable<WeatherData>;
// { city: string | null; temperature: number | null; ... }

// –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è ‚Äî —Ñ—É–Ω–∫—Ü–∏—è-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä
type ValidatorMap<T> = {
  [K in keyof T]: (value: T[K]) => boolean;
};

const weatherValidators: ValidatorMap<WeatherData> = {
  city: (v) => v.length > 0,
  temperature: (v) => v >= -100 && v <= 100,
  humidity: (v) => v >= 0 && v <= 100,
  // ... TypeScript —Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ –ø–æ–ª—è
};

// –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª—è —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ç–∏–ø–æ–º
type OmitByValue<T, V> = {
  [K in keyof T as T[K] extends V ? never : K]: T[K];
};

// WeatherData –±–µ–∑ —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π
type NoNumbers = OmitByValue<WeatherData, number>;
// { city: string; country: string; description: string; icon: string }
```

---

## 6. Mapped Types –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π

–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–æ–±—ã—Ç–∏–π:

```typescript
// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
interface WeatherAppEvents {
  search: { city: string; timestamp: number };
  error: { message: string; code: string };
  settingsChange: { key: string; value: unknown };
}

// –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–∞
type EventHandlers<T> = {
  [K in keyof T]: (event: T[K]) => void;
};

type AppHandlers = EventHandlers<WeatherAppEvents>;
// {
//   search: (event: { city: string; timestamp: number }) => void;
//   error: (event: { message: string; code: string }) => void;
//   settingsChange: (event: { key: string; value: unknown }) => void;
// }
```

TypeScript —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö.

---

## üìä –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

| –ü–∞—Ç—Ç–µ—Ä–Ω | –ö–æ–¥ |
|---|---|
| –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ | `{ [K in keyof T]: T[K] }` |
| –í—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã | `{ [K in keyof T]?: T[K] }` |
| –í—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã | `{ [K in keyof T]-?: T[K] }` |
| –í—Å–µ –ø–æ–ª—è readonly | `{ readonly [K in keyof T]: T[K] }` |
| –£–±—Ä–∞—Ç—å readonly | `{ -readonly [K in keyof T]: T[K] }` |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é | `[K in keyof T as T[K] extends V ? K : never]` |
| –£–±—Ä–∞—Ç—å –∫–ª—é—á–∏ | `[K in keyof T as K extends Bad ? never : K]` |
| –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π | `{ [K in keyof T]: NewType<T[K]> }` |
| –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π | `{ [K in keyof T]: (e: T[K]) => void }` |

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.6.1: –ë–∞–∑–æ–≤—ã–µ mapped —É—Ç–∏–ª–∏—Ç—ã

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –Ω–∞–±–æ—Ä —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ Mapped Types –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–≥–æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/mappedHelpers.ts`:

   ```typescript
   // –î–µ–ª–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è nullable (–¥–æ–±–∞–≤–ª—è–µ—Ç | null –∫ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—é)
   export type Nullable<T> = // TODO

   // –î–µ–ª–∞–µ—Ç –≤—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ (–∞–Ω–∞–ª–æ–≥ Partial, –Ω–æ —è–≤–Ω–æ –Ω–∞—à)
   export type Optional<T> = // TODO

   // –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—è, —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º —Å V
   // –ü–æ–¥—Å–∫–∞–∑–∫–∞: –∏—Å–ø–æ–ª—å–∑—É–π –æ–ø–µ—Ä–∞—Ç–æ—Ä 'as' —Å —É—Å–ª–æ–≤–Ω—ã–º —Ç–∏–ø–æ–º –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
   export type PickByValue<T, V> = // TODO

   // –£–±–∏—Ä–∞–µ—Ç –ø–æ–ª—è, —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º —Å V
   export type OmitByValue<T, V> = // TODO

   // –î–µ–ª–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –º–∞—Å—Å–∏–≤–æ–º
   export type Arrayify<T> = // TODO

   // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è ‚Äî —Ñ—É–Ω–∫—Ü–∏—è-–≥–µ—Ç—Ç–µ—Ä –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç T[K]
   export type Getters<T> = // TODO
   ```

2. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-mapped-helpers.ts` –∏ –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç–∏–ø—ã —Ä–∞–±–æ—Ç–∞—é—Ç:

   ```typescript
   import type {
     Nullable,
     PickByValue,
     OmitByValue,
     Arrayify,
     Getters,
   } from "./src/modules/utils/mappedHelpers";
   import type { WeatherData } from "./src/types/weather";

   // Nullable ‚Äî API –º–æ–≥ –≤–µ—Ä–Ω—É—Ç—å null –¥–ª—è –ª—é–±–æ–≥–æ –ø–æ–ª—è
   type NullableWeather = Nullable<WeatherData>;
   const apiResponse: NullableWeather = {
     city: "–ú–æ—Å–∫–≤–∞",
     temperature: null, // ‚úÖ –¥–æ–ø—É—Å—Ç–∏–º–æ
     feelsLike: null,
     humidity: 80,
     pressure: null,
     windSpeed: null,
     description: "–æ–±–ª–∞—á–Ω–æ",
     icon: null,
     country: "RU",
   };

   // PickByValue ‚Äî —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è WeatherData
   // –û–∂–∏–¥–∞–µ—Ç—Å—è: { temperature: number; feelsLike: number; humidity: number; ... }
   type NumericWeatherFields = PickByValue<WeatherData, number>;

   // OmitByValue ‚Äî —É–±—Ä–∞—Ç—å —á–∏—Å–ª–∞, –æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏
   // –û–∂–∏–¥–∞–µ—Ç—Å—è: { city: string; description: string; icon: string; country: string }
   type TextWeatherFields = OmitByValue<WeatherData, number>;

   // Arrayify ‚Äî –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π
   type WeatherHistory = Arrayify<Pick<WeatherData, "temperature" | "humidity">>;
   const history: WeatherHistory = {
     temperature: [5, 7, 6, 8],
     humidity: [80, 75, 82, 78],
   };

   // Getters ‚Äî –æ–±—ä–µ–∫—Ç, –≥–¥–µ –∫–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è
   type WeatherGetters = Getters<Pick<WeatherData, "city" | "temperature">>;
   const getters: WeatherGetters = {
     city: () => "–ú–æ—Å–∫–≤–∞",
     temperature: () => 5,
   };

   console.log("history:", history);
   console.log("getters.city():", getters.city());
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `PickByValue<WeatherData, number>` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
- `OmitByValue<WeatherData, number>` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è
- `Nullable<T>` –¥–æ–±–∞–≤–ª—è–µ—Ç `| null` –∫ –∫–∞–∂–¥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é, –Ω–µ –¥–µ–ª–∞—è –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `as`</summary>

```typescript
// as T[K] extends V ? K : never
// ‚Äî –µ—Å–ª–∏ —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º —Å V, –∫–ª—é—á –æ—Å—Ç–∞—ë—Ç—Å—è
// ‚Äî –µ—Å–ª–∏ –Ω–µ—Ç, –∫–ª—é—á —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è never, TypeScript –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏—Ä–∞–µ—Ç –µ–≥–æ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

type PickByValue<T, V> = {
  [K in keyof T as /* —É—Å–ª–æ–≤–∏–µ ‚Äî –∫–∞–∫–æ–π –∫–ª—é—á –æ—Å—Ç–∞–≤–∏—Ç—å? */]: T[K];
};
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-mapped-helpers.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.6.2: ValidatorMap ‚Äî —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑—É—è Mapped Types, —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è —Ç–∏–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/validators.ts`:

   ```typescript
   import type { WeatherData } from "../../types/weather";

   // –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∏–ø–∞ V, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true –∏–ª–∏ —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π
   export type ValidatorFn<V> = // TODO

   // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è T ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–∞
   export type ValidatorMap<T> = // TODO

   // –ß–∞—Å—Ç–∏—á–Ω–∞—è –∫–∞—Ä—Ç–∞ ‚Äî –Ω–µ –≤—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã (–∏—Å–ø–æ–ª—å–∑—É–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä ?)
   export type PartialValidatorMap<T> = // TODO

   // –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   export interface ValidationResult {
     valid: boolean;
     errors: Record<string, string>;
   }

   // –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –ø–æ –∫–∞—Ä—Ç–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
   export function validate<T extends object>(
     data: T,
     validators: PartialValidatorMap<T>
   ): ValidationResult {
     const errors: Record<string, string> = {};

     // TODO: –ø—Ä–æ–π–¥–∏—Å—å –ø–æ –∫–ª—é—á–∞–º validators
     // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ –≤—ã–∑–æ–≤–∏ validator(data[key])
     // –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç !== true ‚Äî –¥–æ–±–∞–≤—å –≤ errors[key]

     return {
       valid: Object.keys(errors).length === 0,
       errors,
     };
   }

   // –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–≥–æ–¥—ã ‚Äî TypeScript –ø—Ä–æ–≤–µ—Ä–∏—Ç —Ç–∏–ø—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
   export const weatherDataValidators: PartialValidatorMap<WeatherData> = {
     city: (v) => // TODO: v –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π
     temperature: (v) => // TODO: –¥–∏–∞–ø–∞–∑–æ–Ω -100..100
     humidity: (v) => // TODO: –¥–∏–∞–ø–∞–∑–æ–Ω 0..100
     // TODO: –¥–æ–±–∞–≤—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–ª—è pressure –∏ windSpeed
   };
   ```

2. –î–æ–±–∞–≤—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `src/app.ts`:

   ```typescript
   import { validate, weatherDataValidators } from "./modules/utils/validators";

   // –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç API ‚Äî –ø—Ä–æ–≤–µ—Ä—è–π –∏—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
   function processWeatherData(data: WeatherData): WeatherData | null {
     const result = validate(data, weatherDataValidators);
     if (!result.valid) {
       console.warn("–ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç API:", result.errors);
       return null;
     }
     return data;
   }
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `ValidatorMap<WeatherData>` —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ** –ø–æ–ª—è
- `PartialValidatorMap<WeatherData>` ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π
- `city: (v: number) => true` –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É TypeScript (–Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç–∞)

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ValidatorMap –∏ PartialValidatorMap</summary>

```typescript
// ValidatorMap ‚Äî –≤—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
type ValidatorMap<T> = {
  [K in keyof T]: ValidatorFn<T[K]>;
};

// PartialValidatorMap ‚Äî –≤—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
// –ü–æ–¥—Å–∫–∞–∑–∫–∞: —ç—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ ValidatorMap, –Ω–æ —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º ?
type PartialValidatorMap<T> = {
  [K in keyof T]?: /* ... */;
};
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –ö–∞–∫ –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ validate()</summary>

```typescript
for (const key in validators) {
  const validator = validators[key as keyof T];
  const value = data[key as keyof T];
  if (validator) {
    const result = validator(value as never);
    // result === true ‚Äî –æ–∫, –∏–Ω–∞—á–µ —Å—Ç—Ä–æ–∫–∞ —Å –æ—à–∏–±–∫–æ–π
  }
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.6.3: TypedEventBus ‚Äî —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑—É—è Mapped Types, —Å–æ–∑–¥–∞—Ç—å EventBus, –≥–¥–µ –ø–æ–¥–ø–∏—Å–∫–∞ –∏ —ç–º–∏—Ç —Å–æ–±—ã—Ç–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã ‚Äî TypeScript –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ—Å—ë—Ç –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/EventBus.ts`:

   ```typescript
   // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
   type Handler<T> = (event: T) => void;

   // TODO: —Å–æ–∑–¥–∞–π —Ç–∏–ø HandlersMap<T>
   // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è K –∏–∑ T ‚Äî –º–∞—Å—Å–∏–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ Handler<T[K]>[]
   type HandlersMap<T> = // TODO

   export class EventBus<T extends Record<string, unknown>> {
     private handlers: Partial<HandlersMap<T>> = {};

     // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ
     on<K extends keyof T>(event: K, handler: Handler<T[K]>): void {
       // TODO: –µ—Å–ª–∏ handlers[event] –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
       // –î–æ–±–∞–≤—å handler –≤ –º–∞—Å—Å–∏–≤ handlers[event]
     }

     // –û—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏—è
     off<K extends keyof T>(event: K, handler: Handler<T[K]>): void {
       // TODO: –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–π handler –∏–∑ handlers[event]
     }

     // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º
     emit<K extends keyof T>(event: K, data: T[K]): void {
       // TODO: –≤—ã–∑–æ–≤–∏ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑ handlers[event] —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º data
     }
   }
   ```

2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/types/events.ts` ‚Äî –æ–ø–∏—à–∏ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

   ```typescript
   import type { WeatherData } from "./weather";

   export interface WeatherAppEvents {
     search: {
       city: string;
       timestamp: number;
     };
     searchSuccess: {
       // TODO: city, data (WeatherData), timestamp
     };
     searchError: {
       // TODO: city, error (—Å—Ç—Ä–æ–∫–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º), timestamp
     };
     settingsChange: {
       key: string;
       oldValue: unknown;
       newValue: unknown;
     };
   }
   ```

3. –ü–æ–¥–∫–ª—é—á–∏ EventBus –≤ `src/app.ts`:

   ```typescript
   import { EventBus } from "./modules/utils/EventBus";
   import type { WeatherAppEvents } from "./types/events";

   const eventBus = new EventBus<WeatherAppEvents>();

   // TODO: –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ "search" ‚Äî –≤—ã–≤–æ–¥–∏ city –∏ –≤—Ä–µ–º—è –ø–æ–∏—Å–∫–∞
   // TODO: –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ "searchSuccess" ‚Äî –≤—ã–≤–æ–¥–∏ city –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
   // TODO: –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ "searchError" ‚Äî –≤—ã–≤–æ–¥–∏ city –∏ —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏

   async function searchWeather(city: string) {
     // TODO: —ç–º–∏—Ç–∏—Ä—É–π "search" –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
     try {
       const data = await weatherService.fetchWeather(city);
       // TODO: —ç–º–∏—Ç–∏—Ä—É–π "searchSuccess" —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
     } catch (err) {
       const message = err instanceof Error ? err.message : "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞";
       // TODO: —ç–º–∏—Ç–∏—Ä—É–π "searchError"
     }
   }
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `eventBus.on("search", handler)` ‚Äî handler –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç `{ city: string; timestamp: number }`
- `eventBus.emit("search", { city: 42 })` ‚Äî TypeScript –¥–æ–ª–∂–µ–Ω –≤—ã–¥–∞—Ç—å –æ—à–∏–±–∫—É
- `eventBus.on("unknownEvent", ...)` ‚Äî TypeScript –¥–æ–ª–∂–µ–Ω –≤—ã–¥–∞—Ç—å –æ—à–∏–±–∫—É

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: HandlersMap —á–µ—Ä–µ–∑ Mapped Type</summary>

```typescript
// –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è K ‚Äî –º–∞—Å—Å–∏–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º
type HandlersMap<T> = {
  [K in keyof T]: Handler<T[K]>[];
};
// HandlersMap<WeatherAppEvents>["search"] ‚Üí Handler<{ city: string; timestamp: number }>[]
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –ü–æ—á–µ–º—É K extends keyof T –≤ –º–µ—Ç–æ–¥–∞—Ö –≤–∞–∂–µ–Ω</summary>

```typescript
on<K extends keyof T>(event: K, handler: Handler<T[K]>): void
// –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—à—å on("search", handler):
// ‚Äî TypeScript –≤—ã–≤–æ–¥–∏—Ç K = "search"
// ‚Äî Handler<T["search"]> = Handler<{ city: string; timestamp: number }>
// –í—Å—ë —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ any
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.6.4: FormSchema ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ —Ñ–æ—Ä–º—ã –∏–∑ —Ç–∏–ø–∞

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ö–µ–º—É —Ñ–æ—Ä–º—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è `AppSettings` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥ —Å –ª–µ–π–±–ª–æ–º, —Ç–∏–ø–æ–º –ø–æ–ª—è –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–º.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/ui/settingsForm.ts`:

   ```typescript
   import type { AppSettings } from "../../types/weather";

   // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—è —Ñ–æ—Ä–º—ã ‚Äî generic –ø–æ —Ç–∏–ø—É –∑–Ω–∞—á–µ–Ω–∏—è
   export interface FieldConfig<V> {
     label: string;
     type: "text" | "select" | "toggle" | "number";
     options?: string[];
     validate?: (value: V) => true | string;
   }

   // TODO: —Å–æ–∑–¥–∞–π —Ç–∏–ø FormSchema<T>
   // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è T ‚Äî FieldConfig —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º –∑–Ω–∞—á–µ–Ω–∏—è
   export type FormSchema<T> = // TODO

   // –°—Ö–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚Äî TypeScript –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è AppSettings
   export const settingsFormSchema: FormSchema<AppSettings> = {
     units: {
       // TODO: label, type: "select", options, validate
     },
     lang: {
       // TODO: label, type: "select", options, validate
     },
     theme: {
       // TODO: label, type: "toggle", validate
     },
   };

   // –†–µ–Ω–¥–µ—Ä–∏—Ç —Ñ–æ—Ä–º—É –∏–∑ —Å—Ö–µ–º—ã ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è, –Ω–µ –∑–Ω–∞–µ—Ç –Ω–∏—á–µ–≥–æ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª—è—Ö
   export function renderSettingsForm<T extends object>(
     values: T,
     schema: FormSchema<T>,
     container: HTMLElement
   ): void {
     container.innerHTML = "";

     for (const key in schema) {
       const field = schema[key as keyof T];
       const value = values[key as keyof T];

       const wrapper = document.createElement("div");
       wrapper.className = "settings-field";

       const label = document.createElement("label");
       label.textContent = field.label;

       // TODO: –µ—Å–ª–∏ field.type === "select" ‚Äî —Å–æ–∑–¥–∞–π <select> —Å options
       // –ò–Ω–∞—á–µ ‚Äî —Å–æ–∑–¥–∞–π <input> (checkbox –¥–ª—è toggle, text –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)
       // –î–æ–±–∞–≤—å label –∏ input –≤ wrapper, wrapper –≤ container
     }
   }
   ```

2. –î–æ–±–∞–≤—å –≤ `index.html` –ø–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫:

   ```html
   <div id="settings-panel" style="display:none;">
     <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
     <div id="settings-form"></div>
     <button id="settings-close">–ó–∞–∫—Ä—ã—Ç—å</button>
   </div>
   <button id="settings-open">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
   ```

3. –ü–æ–¥–∫–ª—é—á–∏ —Ñ–æ—Ä–º—É –≤ `src/app.ts`:

   ```typescript
   import { renderSettingsForm, settingsFormSchema } from "./modules/ui/settingsForm";

   const settingsPanel = document.getElementById("settings-panel")!;
   const settingsForm = document.getElementById("settings-form")!;

   document.getElementById("settings-open")!.addEventListener("click", () => {
     renderSettingsForm(currentSettings, settingsFormSchema, settingsForm);
     settingsPanel.style.display = "block";
   });

   document.getElementById("settings-close")!.addEventListener("click", () => {
     settingsPanel.style.display = "none";
   });
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `FormSchema<AppSettings>` —Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ** –ø–æ–ª—è `AppSettings`
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ `AppSettings` ‚Üí TypeScript –ø–æ–∫–∞–∂–µ—Ç –æ—à–∏–±–∫—É –≤ `settingsFormSchema`
- `validate` –≤ `FieldConfig<V>` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø (–¥–ª—è `units` —ç—Ç–æ `"metric" | "imperial"`)

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: FormSchema —á–µ—Ä–µ–∑ Mapped Type</summary>

```typescript
// –ò–¥–µ—è: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ K –∏–∑ T ‚Äî –∫–æ–Ω—Ñ–∏–≥ —Å —Ç–∏–ø–æ–º –∑–Ω–∞—á–µ–Ω–∏—è T[K]
type FormSchema<T> = {
  [K in keyof T]: FieldConfig<T[K]>;
};
// FormSchema<AppSettings>["units"] ‚Üí FieldConfig<"metric" | "imperial">
// validate –≤ –Ω—ë–º: (value: "metric" | "imperial") => true | string
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.6.5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî EventBus + –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–æ–≥–æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–ó–∞–¥–∞—á–∞:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å EventBus –∏ —Ñ–æ—Ä–º—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ä–∞–±–æ—á–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç UI –∏ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –ø–æ–≥–æ–¥—É.

### –®–∞–≥–∏:

1. –û–±–Ω–æ–≤–∏ `src/types/events.ts` ‚Äî —É—Ç–æ—á–Ω–∏ —Ç–∏–ø `settingsChange`:

   ```typescript
   import type { WeatherData, AppSettings } from "./weather";

   export interface WeatherAppEvents {
     search: { city: string; timestamp: number };
     searchSuccess: { city: string; data: WeatherData; timestamp: number };
     searchError: { city: string; error: string; timestamp: number };
     settingsChange: {
       key: keyof AppSettings;
       // TODO: oldValue –∏ newValue ‚Äî —Ç–∏–ø AppSettings[keyof AppSettings]
     };
   }
   ```

2. –î–æ–±–∞–≤—å –≤ `src/app.ts` —Ñ—É–Ω–∫—Ü–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

   ```typescript
   // Generic –ø–æ –∫–ª—é—á—É ‚Äî —á—Ç–æ–±—ã TypeScript –∑–Ω–∞–ª —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è
   function updateSetting<K extends keyof AppSettings>(
     key: K,
     newValue: AppSettings[K]
   ): void {
     // TODO:
     // 1. –°–æ—Ö—Ä–∞–Ω–∏ —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ currentSettings[key]
     // 2. –û–±–Ω–æ–≤–∏ currentSettings[key] = newValue
     // 3. –≠–º–∏—Ç–∏—Ä—É–π "settingsChange" —Å key, oldValue, newValue
     // 4. –°–æ—Ö—Ä–∞–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ localStorage
   }

   // TODO: –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ "settingsChange":
   // ‚Äî –≤—ã–≤–æ–¥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
   // ‚Äî –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è "units" –∏ –µ—Å—Ç—å lastSearchedCity ‚Äî –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å–∏ –ø–æ–≥–æ–¥—É
   ```

3. –î–æ–±–∞–≤—å –ª–æ–≥ —Å–æ–±—ã—Ç–∏–π –≤ `index.html`:

   ```html
   <div id="event-log">
     <h4>–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h4>
     <ul id="event-list"></ul>
   </div>
   ```

4. –î–æ–±–∞–≤—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `src/app.ts`:

   ```typescript
   function logEvent(icon: string, message: string): void {
     const list = document.getElementById("event-list")!;
     const item = document.createElement("li");
     // TODO: –∑–∞–ø–∏—à–∏ –≤—Ä–µ–º—è + —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ item.textContent
     // –î–æ–±–∞–≤—å item –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ prepend
     // –£–¥–∞–ª—è–π –ª–∏—à–Ω–∏–µ –∑–∞–ø–∏—Å–∏ ‚Äî –æ—Å—Ç–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10
   }

   // TODO: –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –≤—Å–µ 4 —Å–æ–±—ã—Ç–∏—è –∏ –≤—ã–∑—ã–≤–∞–π logEvent —Å –ø–æ–¥—Ö–æ–¥—è—â–∏–º —Ç–µ–∫—Å—Ç–æ–º
   // search ‚Üí üîç, searchSuccess ‚Üí ‚úÖ, searchError ‚Üí ‚ùå, settingsChange ‚Üí ‚öôÔ∏è
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `eventBus.emit("settingsChange", { key: "units", ... })` ‚Äî key –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `keyof AppSettings`, –∞ –Ω–µ `string`
- –ü—Ä–∏ —Å–º–µ–Ω–µ `units` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–≥–æ–¥—É
- –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 10 –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü–æ—á–µ–º—É key: keyof AppSettings —Å—Ç—Ä–æ–∂–µ —á–µ–º key: string</summary>

```typescript
// –° key: string ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ:
eventBus.emit("settingsChange", { key: "nonexistent", ... }); // ‚ùå –Ω–µ –ø–æ–π–º–∞–µ–º –æ—à–∏–±–∫—É

// –° key: keyof AppSettings ‚Äî —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏:
eventBus.emit("settingsChange", { key: "units", ... });       // ‚úÖ
eventBus.emit("settingsChange", { key: "nonexistent", ... }); // ‚ùå TypeScript Error
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä. –£–±–µ–¥–∏—Å—å, —á—Ç–æ:
1. –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –≤ –ª–æ–≥–µ —Å–æ–±—ã—Ç–∏–π –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ üîç ‚Üí ‚úÖ –∏–ª–∏ ‚ùå
2. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å ‚öôÔ∏è
3. –°–º–µ–Ω–∞ units –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≥–æ—Ä–æ–¥–∞

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–¥–µ–ª–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ç—ã –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:

- [ ] –ß–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `{ [K in keyof T]: T[K] }`
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã `readonly`, `?`, `-readonly`, `-?`
- [ ] –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ `as T[K] extends V ? K : never`
- [ ] –û–±—ä—è—Å–Ω—è—Ç—å, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã `Partial`, `Required`, `Readonly`, `Pick`, `Omit`
- [ ] –°–æ–∑–¥–∞–≤–∞—Ç—å `ValidatorMap<T>` –∏ `FormSchema<T>` –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ñ–æ—Ä–º
- [ ] –°—Ç—Ä–æ–∏—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π EventBus —Å `EventHandlers<T>`
- [ ] –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å Mapped Types —Å —É—Å–ª–æ–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏

---

## üîó –†–µ—Å—É—Ä—Å—ã

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [Mapped Types](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html) ‚Äî –ø–æ–ª–Ω–∞—è –≥–ª–∞–≤–∞
- [Key Remapping via `as`](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html#key-remapping-via-as) ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä `as`
- [Mapping Modifiers](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html#mapping-modifiers) ‚Äî `+/-` –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã

**–°—Ç–∞—Ç—å–∏:**
- [Mapped Types in TypeScript](https://www.totaltypescript.com/books/total-typescript-essentials/designing-your-types-in-typescript#mapped-types) ‚Äî Total TypeScript
- [TypeScript Mapped Types](https://blog.logrocket.com/typescript-mapped-types/) ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä
- [–ó–∞–º–µ—Ç–∫–∞ –æ Mapped Types –∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ TypeScript](https://habr.com/ru/companies/timeweb/articles/682748/) - –†–∞–∑–±–æ—Ä —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ (ru)

**–í–∏–¥–µ–æ:**
- [Mapped Types ‚Äî –ò–≥–æ—Ä—å –ê–Ω—Ç–æ–Ω–æ–≤](https://www.youtube.com/watch?v=y1bp3hdHLpE)

---

‚è± **–í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ**: 3-4 —á–∞—Å–∞

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ç–µ–º–∞:** [3.2.5 Conditional Types](./3.2.5-Conditional-Types.md)

**–°–ª–µ–¥—É—é—â–∞—è —Ç–µ–º–∞:** [3.2.7 Template Literal Types](./3.2.7-Template-Literal-Types.md)

---

> ## üöÄ –£—Å–∫–æ—Ä—è–µ–º –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
>
> **–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ –¥–ª—è Fullstack-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**
>
> - 7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
> - –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –∫–æ–¥—É –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
> - –ú–∞–∫—Å–∏–º—É–º –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
>
> [**–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –º–µ–Ω—Ç–æ—Ä–∞—Ö, –æ–±—É—á–µ–Ω–∏–∏ –∏ –∫–µ–π—Å–∞—Ö ‚Üí**](https://xmentors.ru/dev)
