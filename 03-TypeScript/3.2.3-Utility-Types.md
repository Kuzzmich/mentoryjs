# 3.2.3 Utility Types

TypeScript –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –Ω–∞–±–æ—Ä–æ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞. Utility Types ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–æ—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∏–ø–æ–≤ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É.

---

## üéØ –ß—Ç–æ —Ç—ã —É–∑–Ω–∞–µ—à—å

- `Partial<T>` ‚Äî —Å–¥–µ–ª–∞—Ç—å –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏
- `Required<T>` –∏ `Readonly<T>` ‚Äî —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º–∏
- `Pick<T, K>` –∏ `Omit<T, K>` ‚Äî –≤—ã–±—Ä–∞—Ç—å –∏–ª–∏ —É–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
- `Record<K, V>` ‚Äî —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- `Exclude<T, U>` –∏ `Extract<T, U>` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è union-—Ç–∏–ø–æ–≤
- `NonNullable<T>` ‚Äî —É–±—Ä–∞—Ç—å `null` –∏ `undefined`
- `ReturnType<T>` –∏ `Parameters<T>` ‚Äî –∏–∑–≤–ª–µ—á—å —Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π
- –ö–æ–≥–¥–∞ –∫–∞–∫–æ–π Utility Type –ø—Ä–∏–º–µ–Ω—è—Ç—å

---

## üìñ –¢–µ–æ—Ä–∏—è

### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã Utility Types?

–ß–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ç–∏–ø–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω—É–∂–Ω—ã –≤—Å–µ –ø–æ–ª—è, –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å, –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ. –ë–µ–∑ Utility Types –ø—Ä–∏—à–ª–æ—Å—å –±—ã –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã:

```typescript
interface User {
  id: number;
  name: string;
  email: string;
  password: string;
}

// ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
interface UpdateUser {
  name?: string;
  email?: string;
  password?: string;
}

// ‚úÖ –û–¥–∏–Ω —Ç–∏–ø ‚Äî —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
type UpdateUser = Partial<Omit<User, "id">>;
```

---

## 1. `Partial<T>`

–î–µ–ª–∞–µ—Ç **–≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏** (`?`):

```typescript
interface WeatherData {
  city: string;
  temperature: number;
  humidity: number;
  windSpeed: number;
}

// –í—Å–µ –ø–æ–ª—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏
type PartialWeather = Partial<WeatherData>;
// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
// {
//   city?: string;
//   temperature?: number;
//   humidity?: number;
//   windSpeed?: number;
// }

function updateWeather(
  current: WeatherData,
  updates: Partial<WeatherData>
): WeatherData {
  return { ...current, ...updates };
}

updateWeather(weatherData, { temperature: 25 }); // ‚úÖ –¢–æ–ª—å–∫–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
```

---

## 2. `Required<T>`

–î–µ–ª–∞–µ—Ç **–≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏** (—É–±–∏—Ä–∞–µ—Ç `?`):

```typescript
interface Config {
  apiKey?: string;
  timeout?: number;
  lang?: string;
}

type StrictConfig = Required<Config>;
// {
//   apiKey: string;
//   timeout: number;
//   lang: string;
// }

function initService(config: Required<Config>) {
  // –í—Å–µ –ø–æ–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –µ—Å—Ç—å
}
```

---

## 3. `Readonly<T>`

–î–µ–ª–∞–µ—Ç **–≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è**:

```typescript
interface AppState {
  city: string;
  temperature: number;
  isLoading: boolean;
}

const state: Readonly<AppState> = {
  city: "–ú–æ—Å–∫–≤–∞",
  temperature: 5,
  isLoading: false,
};

state.city = "–ö–∞–∑–∞–Ω—å"; // ‚ùå Error: Cannot assign to 'city' because it is a read-only property
```

---

## 4. `Pick<T, K>`

**–í—ã–±–∏—Ä–∞–µ—Ç** —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ —Ç–∏–ø–∞:

```typescript
interface WeatherData {
  city: string;
  country: string;
  temperature: number;
  feelsLike: number;
  humidity: number;
  pressure: number;
  windSpeed: number;
  description: string;
  icon: string;
}

// –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
type WeatherCard = Pick<WeatherData, "city" | "temperature" | "description" | "icon">;
// {
//   city: string;
//   temperature: number;
//   description: string;
//   icon: string;
// }

// –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å–µ–∫—Ü–∏–∏
type WeatherDetails = Pick<WeatherData, "humidity" | "pressure" | "windSpeed" | "feelsLike">;
```

---

## 5. `Omit<T, K>`

**–£–±–∏—Ä–∞–µ—Ç** —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ —Ç–∏–ø–∞ (–ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å `Pick`):

```typescript
interface User {
  id: number;
  name: string;
  email: string;
  password: string;
  createdAt: Date;
}

// –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è: –≤—Å—ë –∫—Ä–æ–º–µ id –∏ createdAt (–æ–Ω–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º)
type CreateUser = Omit<User, "id" | "createdAt">;

// –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è: –±–µ–∑ –ø–∞—Ä–æ–ª—è
type PublicUser = Omit<User, "password">;
```

### `Pick` vs `Omit`

```typescript
// –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π Pick
type Short = Pick<WeatherData, "city" | "temperature">; // 2 –ø–æ–ª—è

// –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π Omit
type NoSecret = Omit<User, "password">; // —É–±—Ä–∞—Ç—å 1 –ø–æ–ª–µ –∏–∑ –º–Ω–æ–≥–∏—Ö
```

---

## 6. `Record<K, V>`

–°–æ–∑–¥–∞—ë—Ç **–æ–±—ä–µ–∫—Ç —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ –∏ —Ç–∏–ø–æ–º –∑–Ω–∞—á–µ–Ω–∏–π**:

```typescript
// –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
type CityTemperatures = Record<string, number>;

const temps: CityTemperatures = {
  "–ú–æ—Å–∫–≤–∞": 5,
  "–ö–∞–∑–∞–Ω—å": 8,
  "–°–æ—á–∏": 15,
};

// –ö–ª—é—á–∏ –∏–∑ union-—Ç–∏–ø–∞
type WeatherUnit = "celsius" | "fahrenheit" | "kelvin";
type UnitLabels = Record<WeatherUnit, string>;

const labels: UnitLabels = {
  celsius: "¬∞C",
  fahrenheit: "¬∞F",
  kelvin: "K",
};

// Record —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö
type WeatherCache = Record<string, WeatherData>;
```

---

## 7. `Exclude<T, U>` –∏ `Extract<T, U>`

–§–∏–ª—å—Ç—Ä—É—é—Ç **union-—Ç–∏–ø—ã**:

### `Exclude<T, U>` ‚Äî —É–±–∏—Ä–∞–µ—Ç –∏–∑ T –≤—Å–µ —Ç–∏–ø—ã, –≤—Ö–æ–¥—è—â–∏–µ –≤ U

```typescript
type Status = "loading" | "success" | "error" | "idle";

type ActiveStatus = Exclude<Status, "idle">;
// "loading" | "success" | "error"

type PrimitiveWithoutString = Exclude<string | number | boolean, string>;
// number | boolean
```

### `Extract<T, U>` ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ —Ç–∏–ø—ã –∏–∑ T, –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥—è—Ç –≤ U

```typescript
type Status = "loading" | "success" | "error" | "idle";

type FinishedStatus = Extract<Status, "success" | "error">;
// "success" | "error"
```

---

## 8. `NonNullable<T>`

–£–±–∏—Ä–∞–µ—Ç `null` –∏ `undefined` –∏–∑ —Ç–∏–ø–∞:

```typescript
type MaybeString = string | null | undefined;
type DefinitelyString = NonNullable<MaybeString>;
// string

function processCity(city: string | null | undefined): void {
  const safeCity: NonNullable<typeof city> = city ?? "–ú–æ—Å–∫–≤–∞";
  console.log(safeCity.toUpperCase()); // ‚úÖ –ë–µ–∑ –æ—à–∏–±–∫–∏
}
```

---

## 9. `ReturnType<T>` –∏ `Parameters<T>`

–ò–∑–≤–ª–µ–∫–∞—é—Ç —Ç–∏–ø—ã –∏–∑ **—Ñ—É–Ω–∫—Ü–∏–π**:

### `ReturnType<T>` ‚Äî —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è

```typescript
function fetchWeather(city: string): Promise<WeatherData> {
  // ...
}

type FetchResult = ReturnType<typeof fetchWeather>;
// Promise<WeatherData>

// –ü–æ–ª–µ–∑–Ω–æ –∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∏–ø—É –Ω–∞–ø—Ä—è–º—É—é
function getConfig() {
  return {
    apiKey: "key",
    timeout: 5000,
    lang: "ru",
  };
}

type Config = ReturnType<typeof getConfig>;
// { apiKey: string; timeout: number; lang: string; }
```

### `Parameters<T>` ‚Äî —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏

```typescript
function createWeatherService(
  apiKey: string,
  lang: string,
  cacheTTL: number
): WeatherService {
  return new WeatherService(apiKey, lang, cacheTTL);
}

type ServiceParams = Parameters<typeof createWeatherService>;
// [apiKey: string, lang: string, cacheTTL: number]

// –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
const params: ServiceParams = ["my-key", "ru", 60000];
const service = createWeatherService(...params);
```

---

## 10. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Utility Types

–°–∞–º—ã–π –º–æ—â–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω ‚Äî –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ç–∏–ª–∏—Ç:

```typescript
interface WeatherData {
  city: string;
  country: string;
  temperature: number;
  feelsLike: number;
  humidity: number;
  pressure: number;
  windSpeed: number;
  description: string;
  icon: string;
}

// –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: –≤—Å—ë –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –∫—Ä–æ–º–µ city
type WeatherUpdateForm = Partial<Omit<WeatherData, "city">> & { city: string };

// –¢–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤—Å–µ readonly
type ReadonlyWeatherStats = Readonly<Pick<WeatherData, "temperature" | "humidity" | "pressure" | "windSpeed">>;

// –ü—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–æ–ª–µ–π
type PublicWeather = Omit<Readonly<WeatherData>, "icon">;
```

---

## üìä –ö–æ–≥–¥–∞ —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å

| Utility Type | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|---|---|
| `Partial<T>` | –§–æ—Ä–º—ã, —á–∞—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `Required<T>` | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π, —Å—Ç—Ä–æ–≥–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏ |
| `Readonly<T>` | –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã |
| `Pick<T, K>` | –ü—Ä–æ–µ–∫—Ü–∏–∏ –¥–ª—è UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —á–∞—Å—Ç–∏—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã API |
| `Omit<T, K>` | –£–±—Ä–∞—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–ª—è, CreateDTO –±–µ–∑ id |
| `Record<K, V>` | –°–ª–æ–≤–∞—Ä–∏, –º–∞–ø–ø–∏–Ω–≥–∏, –∫—ç—à-–æ–±—ä–µ–∫—Ç—ã |
| `Exclude<T, U>` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è union-—Ç–∏–ø–æ–≤ |
| `Extract<T, U>` | –°—É–∂–µ–Ω–∏–µ union-—Ç–∏–ø–æ–≤ |
| `NonNullable<T>` | –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ null |
| `ReturnType<T>` | –í—ã–≤–æ–¥ —Ç–∏–ø–∞ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ |
| `Parameters<T>` | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏ |

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.3.1: –¢–∏–ø—ã –¥–ª—è —Ñ–æ—Ä–º –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Partial`, `Required` –∏ `Readonly` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–æ—Ä–º –ø–æ–≥–æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –®–∞–≥–∏:

1. –î–æ–±–∞–≤—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤ `src/types/weather.ts`:

   ```typescript
   // –§–æ—Ä–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–≤—Å–µ –ø–æ–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)
   export type AppSettingsUpdate = Partial<AppSettings>;

   // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã)
   export type InitializedSettings = Required<AppSettings>;

   // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
   export type ImmutableAppState = Readonly<AppState>;

   // –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ä–æ–¥–∞ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
   export interface FavoriteCity {
     city: string;
     country: string;
     addedAt: number;
     label?: string;
   }

   // –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –º–µ—Ç–∫—É (–Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –≥–æ—Ä–æ–¥)
   export type UpdateFavoriteCity = Pick<FavoriteCity, "label">;

   // –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ (–±–µ–∑ —Å–ª—É–∂–µ–±–Ω—ã—Ö –ø–æ–ª–µ–π)
   export type FavoriteCityDisplay = Omit<FavoriteCity, "addedAt">;
   ```

2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/settingsManager.ts`:

   ```typescript
   import type { AppSettings } from "../../types/weather.js";

   // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   const defaultSettings: Required<AppSettings> = {
     // –ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è: units, lang, cacheTTL
   };

   // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
   export function applySettings(
     current: Readonly<AppSettings>,
     updates: Partial<AppSettings>
   ): AppSettings {
     // –í–µ—Ä–Ω–∏ –æ–±—ä–µ–∫—Ç —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
   }

   // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
   export function validateSettings(
     settings: Partial<AppSettings>
   ): settings is Required<AppSettings> {
     // –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
   }
   ```

3. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-settings.ts`:

   ```typescript
   import { applySettings, validateSettings } from "./src/modules/utils/settingsManager";
   import type { AppSettings } from "./src/types/weather";

   const current: AppSettings = {
     units: "celsius",
     lang: "ru",
     cacheTTL: 600000,
   };

   const updated = applySettings(current, { units: "fahrenheit" });
   console.log("‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ:", updated);

   const partial = { units: "celsius" };
   console.log("‚úÖ –í–∞–ª–∏–¥–Ω–æ:", validateSettings(partial as Partial<AppSettings>));
   console.log("‚úÖ –í–∞–ª–∏–¥–Ω–æ:", validateSettings(current));
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `AppSettings` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω –≤ `src/types/weather.ts`
- `applySettings` –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å **–Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç** (–Ω–µ –º—É—Ç–∏—Ä–æ–≤–∞—Ç—å)
- `validateSettings` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **type predicate** (`is Required<AppSettings>`)
- `defaultSettings` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–∏–ø `Required<AppSettings>`

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å AppSettings</summary>

```typescript
// –í src/types/weather.ts
export interface AppSettings {
  units: "celsius" | "fahrenheit";
  lang: string;
  cacheTTL: number;
}
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –§—É–Ω–∫—Ü–∏–∏ settingsManager</summary>

```typescript
const defaultSettings: Required<AppSettings> = {
  units: "celsius",
  lang: "ru",
  cacheTTL: 600000,
};

export function applySettings(
  current: Readonly<AppSettings>,
  updates: Partial<AppSettings>
): AppSettings {
  return { ...current, ...updates };
}

export function validateSettings(
  settings: Partial<AppSettings>
): settings is Required<AppSettings> {
  return (
    settings.units !== undefined &&
    settings.lang !== undefined &&
    settings.cacheTTL !== undefined
  );
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-settings.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.3.2: Pick –∏ Omit –¥–ª—è –ø—Ä–æ–µ–∫—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Ç–æ—á–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –∫–∞—Ä—Ç–æ—á–∫–∞, –¥–µ—Ç–∞–ª–∏, –ø–æ–∏—Å–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –®–∞–≥–∏:

1. –î–æ–±–∞–≤—å –≤ `src/types/weather.ts` –ø—Ä–æ–µ–∫—Ü–∏–∏ –¥–ª—è UI:

   ```typescript
   // –î–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–≥–æ–¥—ã
   export type WeatherCard = Pick<WeatherData, "city" | "country" | "temperature" | "description" | "icon">;

   // –î–ª—è –±–ª–æ–∫–∞ –¥–µ—Ç–∞–ª–µ–π
   export type WeatherDetails = Pick<WeatherData, "feelsLike" | "humidity" | "pressure" | "windSpeed">;

   // –î–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∏—Å–∫–∞ (–±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π)
   export type WeatherSearchResult = Omit<WeatherData, "icon">;

   // –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (—Ç–æ–ª—å–∫–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
   export type WeatherLocation = Pick<WeatherData, "city" | "country">;
   ```

2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/weatherProjections.ts`:

   ```typescript
   import type { WeatherData, WeatherCard, WeatherDetails, WeatherSearchResult } from "../../types/weather.js";

   // –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
   export function toWeatherCard(data: WeatherData): WeatherCard {
     // –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
   }

   // –ò–∑–≤–ª–µ—á—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   export function toWeatherDetails(data: WeatherData): WeatherDetails {
     // –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
   }

   // –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∏—Å–∫–∞
   export function toSearchResult(data: WeatherData): WeatherSearchResult {
     // –í–µ—Ä–Ω–∏ –±–µ–∑ –ø–æ–ª—è icon
   }
   ```

3. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-projections.ts`:

   ```typescript
   import type { WeatherData } from "./src/types/weather";
   import { toWeatherCard, toWeatherDetails, toSearchResult } from "./src/modules/utils/weatherProjections";

   const mockData: WeatherData = {
     city: "–ú–æ—Å–∫–≤–∞", country: "RU",
     temperature: 5, feelsLike: 3,
     humidity: 80, pressure: 1013,
     windSpeed: 3.5, description: "–æ–±–ª–∞—á–Ω–æ", icon: "04d",
   };

   const card = toWeatherCard(mockData);
   console.log("‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞:", Object.keys(card)); // ['city', 'country', 'temperature', 'description', 'icon']

   const details = toWeatherDetails(mockData);
   console.log("‚úÖ –î–µ—Ç–∞–ª–∏:", Object.keys(details)); // ['feelsLike', 'humidity', 'pressure', 'windSpeed']

   const result = toSearchResult(mockData);
   console.log("‚úÖ icon —É–±—Ä–∞–Ω:", !("icon" in result)); // true
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –§—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å **—Ç–æ—á–Ω–æ —Ç–µ –ø–æ–ª—è**, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Ç–∏–ø–µ
- –ò—Å–ø–æ–ª—å–∑—É–π –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª–µ–π
- TypeScript –¥–æ–ª–∂–µ–Ω –≤—ã–¥–∞–≤–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –≤–µ—Ä–Ω—É—Ç—å –ª–∏—à–Ω–∏–µ –ø–æ–ª—è

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ Pick</summary>

```typescript
export function toWeatherCard(data: WeatherData): WeatherCard {
  const { city, country, temperature, description, icon } = data;
  return { city, country, temperature, description, icon };
}
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ Omit</summary>

```typescript
export function toSearchResult(data: WeatherData): WeatherSearchResult {
  const { icon, ...rest } = data;
  return rest;
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-projections.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.3.3: Record –¥–ª—è —Å–ª–æ–≤–∞—Ä–µ–π

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Record` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–æ–∫ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è, –∫–æ–¥–æ–≤ –æ—à–∏–±–æ–∫ –∏ –º–∞–ø–ø–∏–Ω–≥–∞ –∏–∫–æ–Ω–æ–∫.

### –®–∞–≥–∏:

1. –î–æ–±–∞–≤—å –≤ `src/types/weather.ts` –Ω–æ–≤—ã–µ —Ç–∏–ø—ã:

   ```typescript
   export type WeatherUnit = "celsius" | "fahrenheit";
   export type WindUnit = "ms" | "kmh" | "mph";
   export type AppErrorCode = "NOT_FOUND" | "NETWORK_ERROR" | "INVALID_CITY" | "RATE_LIMIT";
   ```

2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/dictionaries.ts`:

   ```typescript
   import type { WeatherUnit, WindUnit, AppErrorCode } from "../../types/weather.js";

   // –ú–µ—Ç–∫–∏ –µ–¥–∏–Ω–∏—Ü —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
   export const temperatureLabels: Record<WeatherUnit, string> = {
     celsius: "¬∞C",
     fahrenheit: "¬∞F",
   };

   // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞ –∏–∑ –º/—Å
   export const windConversionRates: Record<WindUnit, number> = {
     ms: 1,
     kmh: 3.6,
     mph: 2.237,
   };

   // –ú–µ—Ç–∫–∏ –µ–¥–∏–Ω–∏—Ü –≤–µ—Ç—Ä–∞
   export const windUnitLabels: Record<WindUnit, string> = {
     ms: "–º/—Å",
     kmh: "–∫–º/—á",
     mph: "mph",
   };

   // –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   export const errorMessages: Record<AppErrorCode, string> = {
     // –î–æ–±–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–¥–∞
   };

   // –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–¥–æ–≤ –∏–∫–æ–Ω–æ–∫ OpenWeatherMap –≤ —ç–º–æ–¥–∑–∏
   export const weatherIconMap: Record<string, string> = {
     // –î–æ–±–∞–≤—å –º–∞–ø–ø–∏–Ω–≥ –¥–ª—è –∫–æ–¥–æ–≤: '01d', '02d', '03d', '04d', '09d', '10d', '11d', '13d', '50d'
     // –∏ –∏—Ö –Ω–æ—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ '01n' –∏ —Ç.–¥.
   };

   // –ü–æ–ª—É—á–∏—Ç—å —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∏ (—Å —Ñ–æ–ª–±—ç–∫–æ–º)
   export function getWeatherEmoji(iconCode: string): string {
     return weatherIconMap[iconCode] ?? "üå°Ô∏è";
   }
   ```

3. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-dictionaries.ts`:

   ```typescript
   import {
     temperatureLabels,
     windConversionRates,
     errorMessages,
     getWeatherEmoji,
   } from "./src/modules/utils/dictionaries";

   console.log("¬∞C label:", temperatureLabels["celsius"]); // ¬∞C
   console.log("–í–µ—Ç–µ—Ä 5 –º/—Å –≤ –∫–º/—á:", 5 * windConversionRates["kmh"]); // 18
   console.log("–û—à–∏–±–∫–∞:", errorMessages["NOT_FOUND"]);
   console.log("–ò–∫–æ–Ω–∫–∞ —è—Å–Ω–æ:", getWeatherEmoji("01d")); // ‚òÄÔ∏è
   console.log("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞:", getWeatherEmoji("xx")); // üå°Ô∏è
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ö–ª—é—á–∏ `errorMessages` –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–∏–ø—É `AppErrorCode`
- `weatherIconMap` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Record<string, string>` (–∫–ª—é—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏)
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ `AppErrorCode` TypeScript –¥–æ–ª–∂–µ–Ω –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ `errorMessages`

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö</summary>

```typescript
export const errorMessages: Record<AppErrorCode, string> = {
  NOT_FOUND: "–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞",
  NETWORK_ERROR: "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ",
  INVALID_CITY: "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞",
  RATE_LIMIT: "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ",
};
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –ú–∞–ø–ø–∏–Ω–≥ –∏–∫–æ–Ω–æ–∫</summary>

```typescript
export const weatherIconMap: Record<string, string> = {
  "01d": "‚òÄÔ∏è", "01n": "üåô",
  "02d": "üå§Ô∏è", "02n": "üå§Ô∏è",
  "03d": "‚òÅÔ∏è", "03n": "‚òÅÔ∏è",
  "04d": "‚òÅÔ∏è", "04n": "‚òÅÔ∏è",
  "09d": "üåßÔ∏è", "09n": "üåßÔ∏è",
  "10d": "üå¶Ô∏è", "10n": "üå¶Ô∏è",
  "11d": "‚õàÔ∏è", "11n": "‚õàÔ∏è",
  "13d": "‚ùÑÔ∏è", "13n": "‚ùÑÔ∏è",
  "50d": "üå´Ô∏è", "50n": "üå´Ô∏è",
};
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-dictionaries.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.3.4: ReturnType –∏ Parameters

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ReturnType` –∏ `Parameters` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π-–æ–±—ë—Ä—Ç–æ–∫ –∏ middleware.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/utils/functionUtils.ts`:

   ```typescript
   import type { WeatherData } from "../../types/weather.js";
   import { formatTemperature, formatWindSpeed } from "./format.js";

   // –¢–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   type FormattedTemperature = ReturnType<typeof formatTemperature>;
   type FormattedWind = ReturnType<typeof formatWindSpeed>;

   // –¢–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ WeatherService.getData
   // (–æ–ø–∏—Å—ã–≤–∞–µ—Ç, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî —Å—Ç—Ä–æ–∫—É)
   type GetDataParams = Parameters<(city: string) => Promise<WeatherData>>;

   // –§—É–Ω–∫—Ü–∏—è-–æ–±—ë—Ä—Ç–∫–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   export function withLogging<T extends (...args: any[]) => any>(
     fn: T,
     label: string
   ): (...args: Parameters<T>) => ReturnType<T> {
     return (...args: Parameters<T>): ReturnType<T> => {
       console.log(`[${label}] –í—ã–∑–æ–≤ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏:`, args);
       const result = fn(...args);
       console.log(`[${label}] –†–µ–∑—É–ª—å—Ç–∞—Ç:`, result);
       return result;
     };
   }

   // –§—É–Ω–∫—Ü–∏—è-–æ–±—ë—Ä—Ç–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –¥–ª—è async —Ñ—É–Ω–∫—Ü–∏–π
   export function withErrorHandling<T extends (...args: any[]) => Promise<any>>(
     fn: T,
     fallback: Awaited<ReturnType<T>>
   ): (...args: Parameters<T>) => ReturnType<T> {
     return ((...args: Parameters<T>) => {
       return fn(...args).catch((error: Error) => {
         console.error("–û—à–∏–±–∫–∞:", error.message);
         return fallback;
       });
     }) as (...args: Parameters<T>) => ReturnType<T>;
   }
   ```

2. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-function-utils.ts`:

   ```typescript
   import { withLogging, withErrorHandling } from "./src/modules/utils/functionUtils";
   import { formatTemperature } from "./src/modules/utils/format";

   // withLogging
   const loggedFormat = withLogging(formatTemperature, "Format");
   console.log("–†–µ–∑—É–ª—å—Ç–∞—Ç:", loggedFormat(25, 2));

   // withErrorHandling
   async function riskyFetch(city: string): Promise<string> {
     if (city === "fail") throw new Error("–¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞");
     return `–ü–æ–≥–æ–¥–∞ –≤ ${city}`;
   }

   const safeFetch = withErrorHandling(riskyFetch, "–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ");

   async function test() {
     console.log(await safeFetch("–ú–æ—Å–∫–≤–∞")); // "–ü–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–∞"
     console.log(await safeFetch("fail")); // "–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ"
   }

   test();
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `withLogging` –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å **–ø–æ–ª–Ω—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é** –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- `withErrorHandling` –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å **async** —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- TypeScript –¥–æ–ª–∂–µ–Ω –≤—ã–≤–æ–¥–∏—Ç—å —Ç–∏–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ —è–≤–Ω—ã—Ö –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –Ω–∞ call-site

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ó–∞—á–µ–º Parameters –∏ ReturnType</summary>

```typescript
// Parameters<T> –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É:
function withLogging<T extends (...args: any[]) => any>(fn: T, label: string) {
  return (...args: Parameters<T>): ReturnType<T> => {
    // args ‚Äî —Ä–æ–≤–Ω–æ —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á—Ç–æ —É fn
    // TypeScript –∑–Ω–∞–µ—Ç –∏—Ö —Ç–∏–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    return fn(...args);
  };
}

// –ï—Å–ª–∏ –±—ã –Ω–µ –±—ã–ª–æ Parameters, –ø—Ä–∏—à–ª–æ—Å—å –±—ã –ø–∏—Å–∞—Ç—å:
function withLoggingBad(fn: (city: string) => string, label: string) {
  return (city: string): string => fn(city); // ‚ùå –ü—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–µ
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-function-utils.js
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[Format] –í—ã–∑–æ–≤ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏: [ 25, 2 ]
[Format] –†–µ–∑—É–ª—å—Ç–∞—Ç: 25.00¬∞C
–†–µ–∑—É–ª—å—Ç–∞—Ç: 25.00¬∞C
–ü–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–∞
–û—à–∏–±–∫–∞: –¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞
–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.3.5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∞:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å Utility Types –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ ‚Äî —É–ª—É—á—à–∏—Ç—å `src/app.ts` –∏ `WeatherService`, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ–µ–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–ª–æ–≤–∞—Ä–∏ –∏–∫–æ–Ω–æ–∫ –∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

### –®–∞–≥–∏:

1. **–û–±–Ω–æ–≤–∏ `src/app.ts`** ‚Äî –ø–æ–¥–∫–ª—é—á–∏ –Ω–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:

   ```typescript
   // src/app.ts
   import { WeatherService } from "./modules/services/WeatherService.js";
   import { History } from "./modules/utils/History.js";
   import { toWeatherCard, toWeatherDetails } from "./modules/utils/weatherProjections.js";
   import { getWeatherEmoji, temperatureLabels, windUnitLabels } from "./modules/utils/dictionaries.js";
   import type { WeatherData, SearchQuery, AppSettings, WeatherCard, WeatherDetails } from "./types/weather.js";

   // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   let settings: AppSettings = {
     units: "celsius",
     lang: "ru",
     cacheTTL: 600000,
   };
   ```

2. **–û–±–Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏—é `displayWeather`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ–µ–∫—Ü–∏–∏ –∏ —Å–ª–æ–≤–∞—Ä–∏:

   ```typescript
   function displayWeather(data: WeatherData, fromCache: boolean): void {
     currentWeatherData = data;

     // –ò—Å–ø–æ–ª—å–∑—É–π toWeatherCard() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–∫–∏
     const card: WeatherCard = toWeatherCard(data);

     // –ò—Å–ø–æ–ª—å–∑—É–π toWeatherDetails() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π
     const details: WeatherDetails = toWeatherDetails(data);

     // –ò—Å–ø–æ–ª—å–∑—É–π getWeatherEmoji() –¥–ª—è –∏–∫–æ–Ω–∫–∏
     // –ò—Å–ø–æ–ª—å–∑—É–π temperatureLabels[settings.units] –¥–ª—è –º–µ—Ç–∫–∏ –µ–¥–∏–Ω–∏—Ü—ã
     // –ò—Å–ø–æ–ª—å–∑—É–π windUnitLabels["ms"] –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞

     // ... –æ–±–Ω–æ–≤–∏ DOM
   }
   ```

3. **–î–æ–±–∞–≤—å —Å–µ–∫—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫** –≤ `index.html` (–ø–µ—Ä–µ–¥ –∏—Å—Ç–æ—Ä–∏–µ–π):

   ```html
   <div class="settings-bar">
     <div class="unit-switch">
       <button class="unit-btn active" data-unit="celsius">¬∞C</button>
       <button class="unit-btn" data-unit="fahrenheit">¬∞F</button>
     </div>
     <div class="wind-switch">
       <button class="wind-btn active" data-wind="ms">–º/—Å</button>
       <button class="wind-btn" data-wind="kmh">–∫–º/—á</button>
     </div>
   </div>
   ```

4. **–î–æ–±–∞–≤—å —Å—Ç–∏–ª–∏** –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:

   ```html
   <style>
     /* ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ ... */

     .settings-bar {
       display: flex;
       gap: 20px;
       margin-bottom: 20px;
       padding: 12px 15px;
       background: #f0f0f8;
       border-radius: 10px;
       align-items: center;
     }

     .unit-switch, .wind-switch {
       display: flex;
       gap: 6px;
     }

     .unit-btn, .wind-btn {
       padding: 6px 14px;
       border: 2px solid #667eea;
       background: white;
       color: #667eea;
       border-radius: 8px;
       cursor: pointer;
       font-weight: 600;
       font-size: 14px;
       transition: all 0.2s;
     }

     .unit-btn.active, .wind-btn.active {
       background: #667eea;
       color: white;
     }
   </style>
   ```

5. **–û–±–Ω–æ–≤–∏ `displayWeather`** –¥–ª—è –ø–æ–∫–∞–∑–∞ —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü:

   ```typescript
   function displayWeather(data: WeatherData, fromCache: boolean): void {
     currentWeatherData = data;
     const card = toWeatherCard(data);
     const details = toWeatherDetails(data);

     // –û—Ç–æ–±—Ä–∞–∂–∞–π –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–µ–∫—Ü–∏–∏
     // –î–æ–±–∞–≤—å —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫—É —á–µ—Ä–µ–∑ getWeatherEmoji(card.icon)
     // –ü–æ–∫–∞–∑—ã–≤–∞–π –µ–¥–∏–Ω–∏—Ü—ã –∏–∑ settings.units
     // –§–æ—Ä–º–∞—Ç–∏—Ä—É–π –≤–µ—Ç–µ—Ä –≤ –Ω—É–∂–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö

     // ...
   }
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ò—Å–ø–æ–ª—å–∑—É–π `toWeatherCard()` –∏ `toWeatherDetails()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ `data`
- –ò—Å–ø–æ–ª—å–∑—É–π `getWeatherEmoji()` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π `temperatureLabels` –∏ `windUnitLabels` –¥–ª—è –º–µ—Ç–æ–∫ –µ–¥–∏–Ω–∏—Ü
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ **–ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å** –ø–æ–≥–æ–¥—É

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: displayWeather —Å –ø—Ä–æ–µ–∫—Ü–∏—è–º–∏ –∏ —Å–ª–æ–≤–∞—Ä—è–º–∏</summary>

```typescript
function displayWeather(data: WeatherData, fromCache: boolean): void {
  currentWeatherData = data;

  const card = toWeatherCard(data);
  const details = toWeatherDetails(data);

  errorDiv.style.display = "none";
  loadingDiv.style.display = "none";
  weatherCard.style.display = "block";

  cityNameEl.textContent = `${card.city}, ${data.country}`;
  descriptionEl.textContent = `${getWeatherEmoji(card.icon)} ${card.description}`;
  temperatureEl.textContent = WeatherService.formatTemperature(card.temperature, settings.units);

  feelsLikeEl.textContent = WeatherService.formatTemperature(details.feelsLike, settings.units);
  humidityEl.textContent = `${details.humidity}%`;
  pressureEl.textContent = `${details.pressure} hPa`;

  const windRate = windConversionRates[currentWindUnit];
  const windLabel = windUnitLabels[currentWindUnit];
  windEl.textContent = `${(details.windSpeed * windRate).toFixed(1)} ${windLabel}`;

  cacheIndicator.style.display = fromCache ? "block" : "none";
}
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è</summary>

```typescript
let currentWindUnit: WindUnit = "ms";

function setupUnitSwitchers(): void {
  // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  document.querySelectorAll(".unit-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const unit = (btn as HTMLButtonElement).dataset.unit as AppSettings["units"];
      settings = applySettings(settings, { units: unit });
      weatherService.units = unit;

      document.querySelectorAll(".unit-btn").forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");

      if (currentWeatherData) displayWeather(currentWeatherData, false);
    });
  });

  // –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞
  document.querySelectorAll(".wind-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      currentWindUnit = (btn as HTMLButtonElement).dataset.wind as WindUnit;

      document.querySelectorAll(".wind-btn").forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");

      if (currentWeatherData) displayWeather(currentWeatherData, false);
    });
  });
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:

1. –ó–∞–ø—É—Å—Ç–∏ dev-—Å–µ—Ä–≤–µ—Ä:
   ```bash
   npm run dev
   ```

2. –ü—Ä–æ–≤–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
   - ‚úÖ –ò–∫–æ–Ω–∫–∏ –ø–æ–≥–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ —ç–º–æ–¥–∑–∏
   - ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ ¬∞C / ¬∞F —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º/—Å / –∫–º/—á —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ TypeScript –Ω–µ —Ä—É–≥–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤
   - ‚úÖ `displayWeather` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `WeatherCard` –∏ `WeatherDetails`

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–¥–µ–ª–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ç—ã –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:

- [ ] –ü—Ä–∏–º–µ–Ω—è—Ç—å `Partial<T>` –¥–ª—è —Ñ–æ—Ä–º –∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –ü—Ä–∏–º–µ–Ω—è—Ç—å `Required<T>` –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [ ] –ü—Ä–∏–º–µ–Ω—è—Ç—å `Readonly<T>` –¥–ª—è –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –í—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ `Pick<T, K>`
- [ ] –£–±–∏—Ä–∞—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ `Omit<T, K>`
- [ ] –°–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä–∏ —á–µ—Ä–µ–∑ `Record<K, V>`
- [ ] –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å union-—Ç–∏–ø—ã —á–µ—Ä–µ–∑ `Exclude` –∏ `Extract`
- [ ] –ò–∑–≤–ª–µ–∫–∞—Ç—å —Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ `ReturnType` –∏ `Parameters`
- [ ] –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ Utility Types
- [ ] –í—ã–±–∏—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π Utility Type –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏

---

## üîó –†–µ—Å—É—Ä—Å—ã

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [Utility Types](https://www.typescriptlang.org/docs/handbook/utility-types.html) ‚Äî –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç
- [Partial & Required](https://www.typescriptlang.org/docs/handbook/utility-types.html#partialtype) ‚Äî –±–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã
- [ReturnType](https://www.typescriptlang.org/docs/handbook/utility-types.html#returntypetype) ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞

**–°—Ç–∞—Ç—å–∏:**
- [TypeScript Utility Types Explained](https://www.totaltypescript.com/typescript-utility-types) ‚Äî Total TypeScript

**–í–∏–¥–µ–æ:**
- [Utility Types –≤ TypeScript ‚Äî Ulbi TV](https://www.youtube.com/watch?v=LWtHl__oEWc&t=208s)
- [Utility Types –≤ TypeScript —Å –Ω—É–ª—è. –í—Å–µ –£—Ç–∏–ª–∏—Ç—ã –Ω–∞ –ü—Ä–∞–∫—Ç–∏–∫–µ. - wise.js](https://www.youtube.com/watch?v=cQr90ZFWA4g)

---

‚è± **–í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ**: 3-4 —á–∞—Å–∞

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ç–µ–º–∞:** [3.2.2 Generics](./3.2.2-Generics.md)

**–°–ª–µ–¥—É—é—â–∞—è —Ç–µ–º–∞:** [3.2.4 Type Guards –∏ Narrowing](./3.2.4-Type-Guards-–∏-Narrowing.md)

---

> ## üöÄ –£—Å–∫–æ—Ä—è–µ–º –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
>
> **–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ –¥–ª—è Fullstack-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**
>
> - 7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
> - –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –∫–æ–¥—É –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
> - –ú–∞–∫—Å–∏–º—É–º –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
>
> [**–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –º–µ–Ω—Ç–æ—Ä–∞—Ö, –æ–±—É—á–µ–Ω–∏–∏ –∏ –∫–µ–π—Å–∞—Ö ‚Üí**](https://xmentors.ru/dev)
