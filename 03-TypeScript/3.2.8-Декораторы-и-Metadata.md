# 3.2.8 –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏ Metadata

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –∫–ª–∞—Å—Å—ã, –º–µ—Ç–æ–¥—ã, —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤—Ä—É—á–Ω—É—é –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ ‚Äî –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –Ω–∞–¥ –Ω—É–∂–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º.

---

## üéØ –ß—Ç–æ —Ç—ã —É–∑–Ω–∞–µ—à—å

- –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏ –∫–∞–∫ –∏—Ö –≤–∫–ª—é—á–∏—Ç—å –≤ TypeScript
- –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤, –º–µ—Ç–æ–¥–æ–≤, —Å–≤–æ–π—Å—Ç–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –§–∞–±—Ä–∏–∫–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
- Metadata Reflection API –∏ `reflect-metadata`
- –ö–∞–∫ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ NestJS –∏ TypeORM
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤

---

## üìñ –¢–µ–æ—Ä–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏ –∑–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —É —Ç–µ–±—è –µ—Å—Ç—å –º–µ—Ç–æ–¥ `fetchWeather`, –∏ —Ç—ã —Ö–æ—á–µ—à—å –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –µ–≥–æ –≤—ã–∑–æ–≤, –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –∏–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –ë–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ —Ç–µ–ª–æ –º–µ—Ç–æ–¥–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –º–µ—à–∞–Ω–∏–Ω—É:

```typescript
// ‚ùå –ë–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ ‚Äî –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–º–µ—à–∞–Ω–∞ —Å –±–∏–∑–Ω–µ—Å-–∫–æ–¥–æ–º
async fetchWeather(city: string): Promise<WeatherData> {
  console.log(`[LOG] fetchWeather called with: ${city}`);
  const cached = this.cache.get(city);
  if (cached) return cached;
  const start = Date.now();
  const result = await this.api.get(city);
  console.log(`[LOG] fetchWeather took ${Date.now() - start}ms`);
  this.cache.set(city, result);
  return result;
}

// ‚úÖ –° –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏ ‚Äî –∫–∞–∂–¥–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ
@Log()
@Memoize()
@Measure()
async fetchWeather(city: string): Promise<WeatherData> {
  return this.api.get(city);
}
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤ TypeScript —Ç—Ä–µ–±—É—é—Ç —Ñ–ª–∞–≥–∞ –≤ `tsconfig.json`:

```json
{
  "compilerOptions": {
    "experimentalDecorators": true
  }
}
```

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å `Metadata Reflection API` –Ω—É–∂–µ–Ω –ø–∞–∫–µ—Ç:

```bash
npm install reflect-metadata
```

–ò –∏–º–ø–æ—Ä—Ç –≤ —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```typescript
import "reflect-metadata";
```

> **–í–∞–∂–Ω–æ ‚Äî Vite –∏ `emitDecoratorMetadata`:** Vite –∏—Å–ø–æ–ª—å–∑—É–µ—Ç esbuild –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º, –∞ esbuild **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** —Ñ–ª–∞–≥ `emitDecoratorMetadata`. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –Ω—É–∂–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —ç–º–∏—Å—Å–∏–∏ —Ç–∏–ø–æ–≤ –≤ —Ä–∞–Ω—Ç–∞–π–º (–∏–º–µ–Ω–Ω–æ –Ω–∞ –Ω—ë–º —Ä–∞–±–æ—Ç–∞–µ—Ç DI –≤ NestJS –∏ TypeORM). –í—Å–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Reflect.defineMetadata()` –≤—Ä—É—á–Ω—É—é ‚Äî –∏–º `emitDecoratorMetadata` –Ω–µ –Ω—É–∂–µ–Ω, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ `experimentalDecorators: true`.
>
> –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –∑–∞—Ö–æ—á–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `emitDecoratorMetadata` –≤ Vite-–ø—Ä–æ–µ–∫—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ NestJS), –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞–≥–∏–Ω:
>
> ```bash
> npm install -D vite-plugin-babel @babel/core @babel/plugin-proposal-decorators
> ```
>
> ```typescript
> // vite.config.ts
> import babel from "vite-plugin-babel";
>
> export default defineConfig({
>   plugins: [
>     babel({
>       babelHelpers: "bundled",
>       plugins: [["@babel/plugin-proposal-decorators", { legacy: true }]],
>     }),
>   ],
> });
> ```

> **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ vs legacy –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã:** –í TypeScript 5.0+ –ø–æ—è–≤–∏–ª–∏—Å—å "—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ" –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã (TC39 Stage 3) ‚Äî –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç legacy —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º –∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç `experimentalDecorators`. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è **legacy** –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –∏–º–µ–Ω–Ω–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç NestJS –∏ TypeORM.

---

## 1. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏ –º–æ–∂–µ—Ç –µ–≥–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å:

```typescript
// –ü—Ä–æ—Å—Ç–æ–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫ –∫–ª–∞—Å—Å—É
function Sealed(constructor: Function) {
  Object.seal(constructor);          // –Ω–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∫ –∫–ª–∞—Å—Å—É
  Object.seal(constructor.prototype); // –Ω–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã
}

@Sealed
class WeatherService {
  fetchWeather(city: string) { /* ... */ }
}
```

### –§–∞–±—Ä–∏–∫–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ (—Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏)

```typescript
// –§–∞–±—Ä–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
function Logger(prefix: string) {
  return function(constructor: Function) {
    console.log(`[${prefix}] Class created: ${constructor.name}`);
  };
}

@Logger("WeatherApp")
class WeatherService {}
// "[WeatherApp] Class created: WeatherService"
```

---

## 2. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–µ—Ç–æ–¥–æ–≤

–ü–æ–ª—É—á–∞—é—Ç —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: `target` (–ø—Ä–æ—Ç–æ—Ç–∏–ø), `propertyKey` (–∏–º—è –º–µ—Ç–æ–¥–∞), `descriptor` (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä).

```typescript
function Log(target: any, key: string, descriptor: PropertyDescriptor) {
  const original = descriptor.value; // –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥

  descriptor.value = function (...args: any[]) {
    console.log(`[LOG] ${key} called with:`, args);
    const result = original.apply(this, args);
    console.log(`[LOG] ${key} returned:`, result);
    return result;
  };

  return descriptor;
}

class WeatherService {
  @Log
  fetchWeather(city: string) {
    return `Weather in ${city}`;
  }
}
```

---

## 3. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Å–≤–æ–π—Å—Ç–≤

–ü–æ–ª—É—á–∞—é—Ç `target` –∏ `propertyKey`. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥–µ—Ç—Ç–µ—Ä–æ–≤/—Å–µ—Ç—Ç–µ—Ä–æ–≤:

```typescript
function Required(target: any, key: string) {
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
  const required: string[] = Reflect.getMetadata("required", target) ?? [];
  required.push(key);
  Reflect.defineMetadata("required", required, target);
}

class AppConfig {
  @Required
  apiKey: string = "";

  @Required
  baseUrl: string = "";
}
```

---

## 4. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ü–æ–ª—É—á–∞—é—Ç `target`, `propertyKey` –∏ `parameterIndex`:

```typescript
function Param(name: string) {
  return function(target: any, method: string, index: number) {
    const params = Reflect.getMetadata("params", target, method) ?? [];
    params[index] = name;
    Reflect.defineMetadata("params", params, target, method);
  };
}

class WeatherController {
  getWeather(@Param("city") city: string) {
    // Reflect.getMetadata("params", ...) ‚Üí ["city"]
  }
}
```

---

## 5. Metadata Reflection API

`reflect-metadata` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∞—Å—Å–∞—Ö –∏ –º–µ—Ç–æ–¥–∞—Ö. –ò–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω NestJS Dependency Injection:

```typescript
import "reflect-metadata";

// –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
Reflect.defineMetadata("route", "/weather", WeatherController);
Reflect.defineMetadata("method", "GET", WeatherController, "getWeather");

// –ß—Ç–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
const route = Reflect.getMetadata("route", WeatherController);   // "/weather"
const method = Reflect.getMetadata("method", WeatherController, "getWeather"); // "GET"

// emitDecoratorMetadata –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–∏–ø–∞–º TypeScript –≤ —Ä–∞–Ω—Ç–∞–π–º–µ
class WeatherService {
  fetchWeather(city: string): Promise<WeatherData> { /* ... */ }
}
// Reflect.getMetadata("design:paramtypes", WeatherService.prototype, "fetchWeather")
// ‚Üí [String] (—Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ city)
```

---

## 6. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤ NestJS –∏ TypeORM

–≠—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤. –û–Ω–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç –∫–ª–∞—Å—Å—ã –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, —Å–µ—Ä–≤–∏—Å—ã, —Ç–∞–±–ª–∏—Ü—ã –ë–î:

```typescript
// NestJS-—Å—Ç–∏–ª—å
@Injectable()
class WeatherService {
  constructor(private readonly http: HttpService) {}

  @Get("/current")
  async getCurrent(@Query("city") city: string) { /* ... */ }
}

// TypeORM-—Å—Ç–∏–ª—å
@Entity("weather_cache")
class WeatherCache {
  @PrimaryGeneratedColumn()
  id: number;

  @Column()
  city: string;

  @Column("float")
  temperature: number;
}
```

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@Injectable()` –≥–æ–≤–æ—Ä–∏—Ç DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É: "—É–º–µ–π —Å–æ–∑–¥–∞–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–ª–∞—Å—Å –∏ –≤–Ω–µ–¥—Ä—è—Ç—å –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏". `@Column()` –≥–æ–≤–æ—Ä–∏—Ç TypeORM: "—ç—Ç–æ –ø–æ–ª–µ ‚Äî –∫–æ–ª–æ–Ω–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ".

---

## üìä –®–ø–∞—Ä–≥–∞–ª–∫–∞

| –¢–∏–ø | –ê—Ä–≥—É–º–µ–Ω—Ç—ã | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|---|---|---|
| –ö–ª–∞—Å—Å | `constructor: Function` | `@Sealed`, `@Singleton`, `@Injectable` |
| –ú–µ—Ç–æ–¥ | `target, key, descriptor` | `@Log`, `@Memoize`, `@Get`, `@Post` |
| –°–≤–æ–π—Å—Ç–≤–æ | `target, key` | `@Required`, `@Column`, `@Min` |
| –ü–∞—Ä–∞–º–µ—Ç—Ä | `target, key, index` | `@Param`, `@Query`, `@Body` |
| –§–∞–±—Ä–∏–∫–∞ | –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä | `@Logger("prefix")`, `@Min(0)` |
| –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | `Reflect.defineMetadata / getMetadata` | DI, ORM, —Ä–æ—É—Ç–∏–Ω–≥ |

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.8.1: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤ `@Singleton`, `@Sealed` –∏ `@Deprecated` –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –∫ —Å–µ—Ä–≤–∏—Å–∞–º –ø–æ–≥–æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –®–∞–≥–∏:

1. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ `tsconfig.json` –≤–∫–ª—é—á—ë–Ω –Ω—É–∂–Ω—ã–π —Ñ–ª–∞–≥:

   ```json
   {
     "compilerOptions": {
       "experimentalDecorators": true
     }
   }
   ```

2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/decorators/classDecorators.ts`:

   ```typescript
   // @Sealed ‚Äî –∑–∞–ø—Ä–µ—â–∞–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –∫ –∫–ª–∞—Å—Å—É –∏ –µ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø—É
   export function Sealed(constructor: Function): void {
     // TODO: –≤—ã–∑–æ–≤–∏ Object.seal –¥–ª—è constructor –∏ constructor.prototype
   }

   // @Singleton ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–ª–∞—Å—Å –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
   // –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º new ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä
   export function Singleton<T extends { new(...args: any[]): object }>(
     constructor: T
   ): T {
     // TODO: —Å–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é instance (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ undefined)
     // –í–µ—Ä–Ω–∏ –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–π constructor
     // –í constructor –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞: –µ—Å–ª–∏ instance —É–∂–µ –µ—Å—Ç—å ‚Äî –≤–µ—Ä–Ω–∏ –µ–≥–æ (return instance)
     // –ò–Ω–∞—á–µ ‚Äî —Å–æ–∑–¥–∞–π super(...args) –∏ —Å–æ—Ö—Ä–∞–Ω–∏ –≤ instance
     return class extends constructor {
       // TODO
     } as T;
   }

   // @Deprecated ‚Äî –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞
   export function Deprecated(message: string) {
     return function(constructor: Function): void {
       // TODO: –æ–±–µ—Ä–Ω–∏ constructor.prototype.constructor
       // –ü—Ä–∏ –≤—ã–∑–æ–≤–µ ‚Äî –≤—ã–≤–æ–¥–∏ console.warn —Å message, –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–π –æ—Ä–∏–≥–∏–Ω–∞–ª
       const original = constructor.prototype.constructor;
       // TODO: –∑–∞–º–µ–Ω–∏ constructor.prototype.constructor –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é-–æ–±—ë—Ä—Ç–∫—É
     };
   }
   ```

3. –ü—Ä–∏–º–µ–Ω–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫ `src/modules/services/WeatherService.ts`:

   ```typescript
   import { Singleton, Sealed } from "../decorators/classDecorators";

   @Singleton
   @Sealed
   export class WeatherService {
     // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
   }
   ```

4. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-class-decorators.ts`:

   ```typescript
   import { Singleton, Sealed, Deprecated } from "./src/modules/decorators/classDecorators";

   @Singleton
   class ApiClient {
     constructor(public baseUrl: string) {}
   }

   const a = new ApiClient("https://api1.example.com");
   const b = new ApiClient("https://api2.example.com");

   // TODO: —á—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ –∏ –ø–æ—á–µ–º—É?
   console.log(a === b); // –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ???

   @Deprecated("–ò—Å–ø–æ–ª—å–∑—É–π WeatherService –≤–º–µ—Å—Ç–æ OldWeatherClient")
   class OldWeatherClient {
     fetch() { return "old data"; }
   }

   const old = new OldWeatherClient(); // –¥–æ–ª–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `new ApiClient(...)` –¥–≤–∞–∂–¥—ã ‚Üí –æ–±–∞ —Ä–∞–∑–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç
- `new OldWeatherClient()` ‚Üí –≤—ã–≤–æ–¥–∏—Ç `console.warn` —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- `@Sealed` –∑–∞–ø—Ä–µ—â–∞–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∫ WeatherService

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –ü–∞—Ç—Ç–µ—Ä–Ω Singleton —á–µ—Ä–µ–∑ –∑–∞–º—ã–∫–∞–Ω–∏–µ</summary>

```typescript
export function Singleton<T extends { new(...args: any[]): object }>(constructor: T): T {
  let instance: InstanceType<T> | undefined;

  return class extends constructor {
    constructor(...args: any[]) {
      if (instance) return instance; // –≤–µ—Ä–Ω—É—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä
      super(...args);
      instance = this as InstanceType<T>;
    }
  } as T;
}
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –§–∞–±—Ä–∏–∫–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã</summary>

```typescript
// –í—ã–∑–æ–≤ @Deprecated("—Å–æ–æ–±—â–µ–Ω–∏–µ") ‚Äî —ç—Ç–æ –≤—ã–∑–æ–≤ —Ñ–∞–±—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
export function Deprecated(message: string) {
  return function(constructor: Function) {
    // –∑–¥–µ—Å—å –ø–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ message —á–µ—Ä–µ–∑ –∑–∞–º—ã–∫–∞–Ω–∏–µ
    const original = constructor; // —Å–æ—Ö—Ä–∞–Ω–∏ —Å—Å—ã–ª–∫—É
    // ...
  };
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-class-decorators.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.8.2: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–µ—Ç–æ–¥–æ–≤

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–µ—Ç–æ–¥–æ–≤ `@Log`, `@Memoize` –∏ `@Throttle` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –≤—ã–∑–æ–≤–æ–≤.

### –®–∞–≥–∏:

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/decorators/methodDecorators.ts`:

   ```typescript
   // @Log ‚Äî –ª–æ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞: –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   export function Log(
     target: any,
     propertyKey: string,
     descriptor: PropertyDescriptor
   ): PropertyDescriptor {
     const original = descriptor.value;

     descriptor.value = async function (...args: any[]) {
       // TODO: –∑–∞–ø–∏—à–∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —á–µ—Ä–µ–∑ Date.now()
       // TODO: –≤—ã–≤–µ–¥–∏ console.log —Å –∏–º–µ–Ω–µ–º –º–µ—Ç–æ–¥–∞ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
       // TODO: –≤—ã–∑–æ–≤–∏ original.apply(this, args) –∏ —Å–æ—Ö—Ä–∞–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
       // TODO: –≤—ã–≤–µ–¥–∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
       // TODO: –≤–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
     };

     return descriptor;
   }

   // @Memoize ‚Äî –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
   // –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ —Å —Ç–µ–º–∏ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   export function Memoize(
     target: any,
     propertyKey: string,
     descriptor: PropertyDescriptor
   ): PropertyDescriptor {
     const original = descriptor.value;
     // TODO: —Å–æ–∑–¥–∞–π Map –¥–ª—è –∫—ç—à–∞ (–∫–ª—é—á ‚Äî JSON.stringify(args))

     descriptor.value = async function (...args: any[]) {
       // TODO: –ø—Ä–æ–≤–µ—Ä—å, –µ—Å—Ç—å –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫—ç—à–µ
       // –ï—Å–ª–∏ –¥–∞ ‚Äî –≤–µ—Ä–Ω–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–≤—ã–≤–µ–¥–∏ "[CACHE HIT]" –≤ –∫–æ–Ω—Å–æ–ª—å)
       // –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–∑–æ–≤–∏ original, —Å–æ—Ö—Ä–∞–Ω–∏ –≤ –∫—ç—à, –≤–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
     };

     return descriptor;
   }

   // @Throttle(ms) ‚Äî —Ñ–∞–±—Ä–∏–∫–∞: –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥ —á–∞—â–µ, —á–µ–º —Ä–∞–∑ –≤ ms –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
   export function Throttle(ms: number) {
     return function(
       target: any,
       propertyKey: string,
       descriptor: PropertyDescriptor
     ): PropertyDescriptor {
       const original = descriptor.value;
       // TODO: —Å–æ–∑–¥–∞–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é lastCall (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ 0)

       descriptor.value = function (...args: any[]) {
         const now = Date.now();
         // TODO: –µ—Å–ª–∏ —Å lastCall –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ ms ‚Äî –≤—ã–±—Ä–æ—Å–∏ –æ—à–∏–±–∫—É –∏–ª–∏ –≤–µ—Ä–Ω–∏ undefined
         // –ò–Ω–∞—á–µ ‚Äî –æ–±–Ω–æ–≤–∏ lastCall –∏ –≤—ã–∑–æ–≤–∏ original
       };

       return descriptor;
     };
   }
   ```

2. –ü—Ä–∏–º–µ–Ω–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫ `src/modules/services/WeatherService.ts`:

   ```typescript
   import { Log, Memoize, Throttle } from "../decorators/methodDecorators";

   export class WeatherService {
     // @Log –≤—ã–≤–æ–¥–∏—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞
     // @Memoize –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∏–º–µ–Ω–∏ –≥–æ—Ä–æ–¥–∞
     // @Throttle(1000) –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —á–∞—â–µ —Ä–∞–∑–∞ –≤ —Å–µ–∫—É–Ω–¥—É
     @Log
     @Memoize
     @Throttle(1000)
     async fetchWeather(city: string): Promise<WeatherData> {
       // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
     }
   }
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `@Log` –≤—ã–≤–æ–¥–∏—Ç –∏–º—è –º–µ—Ç–æ–¥–∞, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º—Å
- `@Memoize` –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–∑–æ–≤–µ —Å —Ç–µ–º–∏ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –Ω–µ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ API
- `@Throttle(1000)` –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤, –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 1000 –º—Å

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ ‚Äî —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö</summary>

```typescript
// –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö:
@Log       // ‚Üê –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º (–≤–Ω–µ—à–Ω–∏–π —Å–ª–æ–π)
@Memoize   // ‚Üê –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –≤—Ç–æ—Ä—ã–º
@Throttle(1000) // ‚Üê –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –ø–µ—Ä–≤—ã–º (–±–ª–∏–∂–∞–π—à–∏–π –∫ –º–µ—Ç–æ–¥—É)
async fetchWeather(city: string) {}

// –ü–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞ –ø—Ä–∏ fetchWeather("Moscow"):
// Throttle –ø—Ä–æ–≤–µ—Ä—è–µ—Ç ‚Üí Memoize –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à ‚Üí Log –ª–æ–≥–∏—Ä—É–µ—Ç ‚Üí –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-method-decorators.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.8.3: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Å–≤–æ–π—Å—Ç–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Å–≤–æ–π—Å—Ç–≤ `@Required`, `@Min`, `@Max`, `@Length` –∏ —Ñ—É–Ω–∫—Ü–∏—é `validate()`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—ä–µ–∫—Ç –ø–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º.

### –®–∞–≥–∏:

1. –£—Å—Ç–∞–Ω–æ–≤–∏ –ø–∞–∫–µ—Ç:

   ```bash
   npm install reflect-metadata
   ```

2. –î–æ–±–∞–≤—å –∏–º–ø–æ—Ä—Ç –≤ –Ω–∞—á–∞–ª–æ `src/app.ts`:

   ```typescript
   import "reflect-metadata";
   ```

3. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/modules/decorators/propertyDecorators.ts`:

   ```typescript
   import "reflect-metadata";

   const VALIDATORS_KEY = "validators";

   interface ValidatorRule {
     type: "required" | "min" | "max" | "length";
     value?: number;
     message: string;
   }

   // –•–µ–ª–ø–µ—Ä: –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫ –ø–æ–ª—é —á–µ—Ä–µ–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   function addRule(target: object, key: string, rule: ValidatorRule): void {
     // TODO: –ø—Ä–æ—á–∏—Ç–∞–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —á–µ—Ä–µ–∑ Reflect.getMetadata(VALIDATORS_KEY, target, key)
     // –î–æ–±–∞–≤—å –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ, —Å–æ—Ö—Ä–∞–Ω–∏ —á–µ—Ä–µ–∑ Reflect.defineMetadata
   }

   // @Required ‚Äî –ø–æ–ª–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç—ã–º (–Ω–µ null, –Ω–µ undefined, –Ω–µ "")
   export function Required(target: object, key: string): void {
     // TODO: –≤—ã–∑–æ–≤–∏ addRule —Å —Ç–∏–ø–æ–º "required"
   }

   // @Min(n) ‚Äî —á–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >= n
   export function Min(min: number) {
     return function(target: object, key: string): void {
       // TODO: –≤—ã–∑–æ–≤–∏ addRule —Å —Ç–∏–ø–æ–º "min" –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º min
     };
   }

   // @Max(n) ‚Äî —á–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å <= n
   export function Max(max: number) {
     return function(target: object, key: string): void {
       // TODO: –≤—ã–∑–æ–≤–∏ addRule —Å —Ç–∏–ø–æ–º "max" –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º max
     };
   }

   // @Length(min, max) ‚Äî –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
   export function Length(min: number, max: number) {
     return function(target: object, key: string): void {
       // TODO: –¥–æ–±–∞–≤—å –¥–≤–∞ –ø—Ä–∞–≤–∏–ª–∞ ‚Äî min –∏ max –¥–ª—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–∏
     };
   }

   // –ß–∏—Ç–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—ä–µ–∫—Ç –ø–æ –≤—Å–µ–º –ø—Ä–∞–≤–∏–ª–∞–º
   export function validate(instance: object): { valid: boolean; errors: string[] } {
     const errors: string[] = [];
     const proto = Object.getPrototypeOf(instance);

     // TODO: –ø—Ä–æ–π–¥–∏—Å—å –ø–æ –≤—Å–µ–º –∫–ª—é—á–∞–º instance
     // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞ –ø—Ä–æ—á–∏—Ç–∞–π –ø—Ä–∞–≤–∏–ª–∞: Reflect.getMetadata(VALIDATORS_KEY, proto, key)
     // –ü—Ä–æ–≤–µ—Ä—å –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ –∏ –¥–æ–±–∞–≤—å –æ—à–∏–±–∫–∏ –≤ –º–∞—Å—Å–∏–≤ errors
     // –í–µ—Ä–Ω–∏ { valid: errors.length === 0, errors }
     return { valid: errors.length === 0, errors };
   }
   ```

4. –°–æ–∑–¥–∞–π –∫–ª–∞—Å—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `src/types/config.ts`:

   ```typescript
   import { Required, Min, Max, Length } from "../modules/decorators/propertyDecorators";

   export class WeatherAppConfig {
     @Required
     @Length(10, 100)
     apiKey: string = "";

     @Required
     baseUrl: string = "https://api.openweathermap.org";

     @Min(1000)
     @Max(30000)
     timeout: number = 5000;

     @Min(0)
     @Max(100)
     cacheSize: number = 50;
   }
   ```

5. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test-property-decorators.ts`:

   ```typescript
   import { validate } from "./src/modules/decorators/propertyDecorators";
   import { WeatherAppConfig } from "./src/types/config";

   // –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
   const badConfig = new WeatherAppConfig();
   badConfig.apiKey = "";         // –Ω–∞—Ä—É—à–∞–µ—Ç @Required –∏ @Length(10, 100)
   badConfig.timeout = 999;      // –Ω–∞—Ä—É—à–∞–µ—Ç @Min(1000)

   const result = validate(badConfig);
   console.log("valid:", result.valid);     // false
   console.log("errors:", result.errors);   // —Å–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫

   // –í–∞–ª–∏–¥–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
   const goodConfig = new WeatherAppConfig();
   goodConfig.apiKey = "abcdefghij123456";
   goodConfig.timeout = 5000;

   const result2 = validate(goodConfig);
   console.log("valid:", result2.valid);    // true
   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `validate(config)` —á–∏—Ç–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞
- `@Min(1000)` –Ω–∞ –ø–æ–ª–µ `timeout: 999` ‚Üí –æ—à–∏–±–∫–∞ –≤ –º–∞—Å—Å–∏–≤–µ
- `@Required` –Ω–∞ –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–µ ‚Üí –æ—à–∏–±–∫–∞ –≤ –º–∞—Å—Å–∏–≤–µ
- –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ–¥–Ω–æ–º –ø–æ–ª–µ

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 1: –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Reflect.getMetadata –∏ defineMetadata</summary>

```typescript
// –°–æ—Ö—Ä–∞–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞:
Reflect.defineMetadata(VALIDATORS_KEY, rules, target, propertyKey);

// –ü—Ä–æ—á–∏—Ç–∞–π –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
const rules = Reflect.getMetadata(VALIDATORS_KEY, proto, key) as ValidatorRule[] | undefined;
```
</details>

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞ 2: –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</summary>

```typescript
export function validate(instance: object) {
  const proto = Object.getPrototypeOf(instance);
  for (const key of Object.keys(instance)) {
    const rules = Reflect.getMetadata(VALIDATORS_KEY, proto, key) as ValidatorRule[];
    if (!rules) continue;
    const value = (instance as Record<string, unknown>)[key];
    for (const rule of rules) {
      // –ø—Ä–æ–≤–µ—Ä—è–π rule.type –∏ value
    }
  }
}
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-property-decorators.js
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ 3.2.8.4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤ –ø–æ–≥–æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–ó–∞–¥–∞—á–∞:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫ —Ä–µ–∞–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ.

### –®–∞–≥–∏:

1. –û–±–Ω–æ–≤–∏ `src/modules/services/WeatherService.ts` ‚Äî –¥–æ–±–∞–≤—å –≤—Å–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã:

   ```typescript
   import "reflect-metadata";
   import { Singleton, Sealed } from "../decorators/classDecorators";
   import { Log, Memoize, Throttle } from "../decorators/methodDecorators";

   @Singleton
   @Sealed
   export class WeatherService {
     // TODO: –ø—Ä–∏–º–µ–Ω–π @Log –∏ @Memoize –∫ fetchWeather
     // @Throttle(2000) ‚Äî –Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ 2 —Å–µ–∫—É–Ω–¥—ã
     async fetchWeather(city: string): Promise<WeatherData> {
       // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
     }
   }
   ```

2. –°–æ–∑–¥–∞–π –∏ –ø—Ä–æ–≤–∞–ª–∏–¥–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤ `src/app.ts`:

   ```typescript
   import "reflect-metadata";
   import { WeatherAppConfig } from "./types/config";
   import { validate } from "./modules/decorators/propertyDecorators";

   // –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä—è–π –∫–æ–Ω—Ñ–∏–≥
   const config = new WeatherAppConfig();
   config.apiKey = import.meta.env.VITE_API_KEY ?? "";
   config.timeout = 5000;

   const configCheck = validate(config);
   if (!configCheck.valid) {
     // TODO: –≤—ã–≤–µ–¥–∏ –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
     throw new Error(`–ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:\n${configCheck.errors.join("\n")}`);
   }

   const weatherService = new WeatherService();
   ```

3. –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç `test-integration.ts`:

   ```typescript
   // –ü—Ä–æ–≤–µ—Ä—è–µ–º Singleton
   const s1 = new WeatherService();
   const s2 = new WeatherService();
   console.assert(s1 === s2, "Singleton: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä");

   // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥–∞
   import { WeatherAppConfig } from "./src/types/config";
   import { validate } from "./src/modules/decorators/propertyDecorators";

   const cfg = new WeatherAppConfig();
   cfg.apiKey = "";
   const { valid, errors } = validate(cfg);
   console.assert(!valid, "–ü—É—Å—Ç–æ–π apiKey –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º");
   console.log("–û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞:", errors);

   ```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- `WeatherService` ‚Äî Singleton, –Ω–µ–ª—å–∑—è —Ä–∞—Å—à–∏—Ä–∏—Ç—å (`@Sealed`)
- `fetchWeather` –ª–æ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤—ã, –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —á–∞—Å—Ç–æ—Ç–æ–π
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ‚Üí –æ—à–∏–±–∫–∞ —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü–æ—Ä—è–¥–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ reflect-metadata –≤–∞–∂–µ–Ω</summary>

```typescript
// –í —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ (src/app.ts) ‚Äî –ü–ï–†–í–´–ú –∏–º–ø–æ—Ä—Ç–æ–º:
import "reflect-metadata";
// –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã ‚Äî –ø–æ—Å–ª–µ
import { WeatherService } from "./modules/services/WeatherService";
// ...

// –ï—Å–ª–∏ reflect-metadata –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Reflect.getMetadata ‚Äî
// —Ç—ã –ø–æ–ª—É—á–∏—à—å –æ—à–∏–±–∫—É "Reflect is not defined" –≤ —Ä–∞–Ω—Ç–∞–π–º–µ
```
</details>

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
npm run build && node dist/test-integration.js
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–¥–µ–ª–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ç—ã –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:

- [ ] –í–∫–ª—é—á–∞—Ç—å `experimentalDecorators` –∏ `emitDecoratorMetadata` –≤ `tsconfig.json`
- [ ] –ü–∏—Å–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤, –º–µ—Ç–æ–¥–æ–≤ –∏ —Å–≤–æ–π—Å—Ç–≤
- [ ] –°–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–∞–±—Ä–∏–∫–∏ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ (—Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Reflect.defineMetadata` –∏ `Reflect.getMetadata`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `@Singleton`, `@Log`, `@Memoize` —Å –Ω—É–ª—è
- [ ] –ü–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ NestJS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è DI –∏ —Ä–æ—É—Ç–∏–Ω–≥–∞
- [ ] –û–±—ä—è—Å–Ω—è—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É legacy –∏ TC39 –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏

---

## üîó –†–µ—Å—É—Ä—Å—ã

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [Decorators](https://www.typescriptlang.org/docs/handbook/decorators.html) ‚Äî –ø–æ–ª–Ω–∞—è –≥–ª–∞–≤–∞ (legacy)
- [reflect-metadata](https://github.com/rbuckton/reflect-metadata) ‚Äî –ø–∞–∫–µ—Ç –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—å–∏:**
- [A Complete Guide to TypeScript Decorators](https://saul-mirone.github.io/a-complete-guide-to-typescript-decorator/) ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
- [–ú–æ–≥—É—á–∏–µ Typescript –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã](https://habr.com/ru/articles/494668/) ‚Äî –†–∞–∑–±–æ—Ä –Ω–∞ —Ä—É—Å—Å–∫–æ–º

**–í–∏–¥–µ–æ:**
- [TypeScript Decorators ‚Äî Fireship](https://www.youtube.com/watch?v=O6A-u_FoEX8)
- [TypeScript. Class decorator. Decorator factory - –ú–∞–∫—Å–∏–º –ì—Ä–æ–º](https://www.youtube.com/watch?v=ZCrExFH2bSA)

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:**
- [NestJS Controllers](https://docs.nestjs.com/controllers) ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ
- [TypeORM Decorators](https://typeorm.io/#/entities) ‚Äî Entity, Column, PrimaryGeneratedColumn

---

‚è± **–í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ**: 4-5 —á–∞—Å–æ–≤

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ç–µ–º–∞:** [3.2.7 Template Literal Types](./3.2.7-Template-Literal-Types.md)

**–°–ª–µ–¥—É—é—â–∞—è —Ç–µ–º–∞:** [3.2.9 Declaration Merging –∏ Module Augmentation](./3.2.9-Declaration-Merging.md)

---

[![–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](../static/callout.svg)](https://xmentors.ru/dev?utm_source=baza_js)
