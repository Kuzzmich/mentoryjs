# 2.2.6 –†–∞–±–æ—Ç–∞ —Å API (fetch)

Fetch API ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ª–∞—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å—ã –≤ JavaScript. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å –±—ç–∫–µ–Ω–¥–æ–º.

---

## üéØ –ß—Ç–æ —Ç—ã —É–∑–Ω–∞–µ—à—å

- –ß—Ç–æ —Ç–∞–∫–æ–µ HTTP –∏ REST API
- –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Fetch API
- HTTP –º–µ—Ç–æ–¥—ã: GET, POST, PUT, DELETE
- –†–∞–±–æ—Ç–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ —Ç–µ–ª–æ–º –∑–∞–ø—Ä–æ—Å–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ (JSON, —Ç–µ–∫—Å—Ç, blob)
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- CORS –∏ —Å–ø–æ—Å–æ–±—ã —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ API

---

## üìñ –ß—Ç–æ —Ç–∞–∫–æ–µ API

**API (Application Programming Interface)** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ–≥—Ä–∞–º–º –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.

### REST API

**REST** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤.

```
GET    /api/users          # –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
GET    /api/users/123      # –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å id=123
POST   /api/users          # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PUT    /api/users/123      # –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å id=123
DELETE /api/users/123      # –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å id=123
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã REST:**
- –ö–∞–∂–¥—ã–π —Ä–µ—Å—É—Ä—Å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π URL
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã
- Stateless ‚Äî –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º
- –î–∞–Ω–Ω—ã–µ –æ–±—ã—á–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

---

## üìñ Fetch API ‚Äî –û—Å–Ω–æ–≤—ã

### –ü—Ä–æ—Å—Ç–æ–π GET –∑–∞–ø—Ä–æ—Å

```javascript
// –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –∑–∞–ø—Ä–æ—Å
fetch('https://api.example.com/data')
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error('–û—à–∏–±–∫–∞:', error));
```

### –° async/await (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```javascript
async function fetchData() {
  try {
    const response = await fetch('https://api.example.com/data');
    const data = await response.json();
    console.log(data);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Response

```javascript
const response = await fetch('https://api.example.com/data');

console.log(response.status);      // 200
console.log(response.statusText);  // "OK"
console.log(response.ok);          // true (–¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ 200-299)
console.log(response.headers);     // Headers –æ–±—ä–µ–∫—Ç
console.log(response.url);         // URL –∑–∞–ø—Ä–æ—Å–∞
```

---

## üìñ HTTP –º–µ—Ç–æ–¥—ã

### GET ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```javascript
// –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
const response = await fetch('https://api.example.com/users');

// –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤ URL
const userId = 123;
const response = await fetch(`https://api.example.com/users/${userId}`);

// –° query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
const params = new URLSearchParams({
  search: 'John',
  limit: 10,
  page: 1
});
const response = await fetch(`https://api.example.com/users?${params}`);
// URL: https://api.example.com/users?search=John&limit=10&page=1
```

### POST ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```javascript
const newUser = {
  name: 'John Doe',
  email: 'john@example.com'
};

const response = await fetch('https://api.example.com/users', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(newUser)
});

const data = await response.json();
console.log('–°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', data);
```

### PUT ‚Äî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```javascript
const updatedUser = {
  name: 'John Smith',
  email: 'john.smith@example.com'
};

const response = await fetch('https://api.example.com/users/123', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(updatedUser)
});
```

### DELETE ‚Äî –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```javascript
const response = await fetch('https://api.example.com/users/123', {
  method: 'DELETE'
});

if (response.ok) {
  console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω');
}
```

### PATCH ‚Äî –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```javascript
// –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ email
const response = await fetch('https://api.example.com/users/123', {
  method: 'PATCH',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({ email: 'newemail@example.com' })
});
```

---

## üìñ –†–∞–±–æ—Ç–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

```javascript
const response = await fetch('https://api.example.com/data', {
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_TOKEN',
    'Accept': 'application/json',
    'X-Custom-Header': 'custom-value'
  }
});
```

### –ß—Ç–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –æ—Ç–≤–µ—Ç–∞

```javascript
const response = await fetch('https://api.example.com/data');

// –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
console.log(response.headers.get('Content-Type'));

// –ü–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
for (let [key, value] of response.headers) {
  console.log(`${key}: ${value}`);
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
if (response.headers.has('X-Rate-Limit')) {
  console.log('Rate limit:', response.headers.get('X-Rate-Limit'));
}
```

---

## üìñ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### JSON (—Å–∞–º—ã–π —á–∞—Å—Ç—ã–π)

```javascript
const response = await fetch('https://api.example.com/data');
const data = await response.json();
console.log(data);
```

### –¢–µ–∫—Å—Ç

```javascript
const response = await fetch('https://example.com/text');
const text = await response.text();
console.log(text);
```

### Blob (—Ñ–∞–π–ª—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)

```javascript
const response = await fetch('https://example.com/image.jpg');
const blob = await response.blob();

// –°–æ–∑–¥–∞—Ç—å URL –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
const imageUrl = URL.createObjectURL(blob);
document.getElementById('img').src = imageUrl;
```

### FormData (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)

```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);
formData.append('description', 'My file');

const response = await fetch('https://api.example.com/upload', {
  method: 'POST',
  body: formData
  // –ù–µ —É–∫–∞–∑—ã–≤–∞–π Content-Type! –ë—Ä–∞—É–∑–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
});
```

---

## üìñ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –î–≤–∞ —Ç–∏–ø–∞ –æ—à–∏–±–æ–∫

1. **Network errors** ‚Äî —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
2. **HTTP errors** ‚Äî —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª —Å –æ—à–∏–±–∫–æ–π (404, 500, etc.)

```javascript
async function fetchWithErrorHandling(url) {
  try {
    const response = await fetch(url);

    // Fetch –ù–ï –±—Ä–æ—Å–∞–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ HTTP 4xx/5xx
    // –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å response.ok –≤—Ä—É—á–Ω—É—é
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const data = await response.json();
    return data;
  } catch (error) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ network errors –∏ –Ω–∞—à–∏—Ö HTTP errors
    console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:', error);
    throw error;
  }
}
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤

```javascript
async function fetchData(url) {
  try {
    const response = await fetch(url);

    if (response.status === 200) {
      return await response.json();
    } else if (response.status === 404) {
      throw new Error('–†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω');
    } else if (response.status === 401) {
      throw new Error('–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è');
    } else if (response.status === 403) {
      throw new Error('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω');
    } else if (response.status === 500) {
      throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
    } else {
      throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: ${response.status}`);
    }
  } catch (error) {
    if (error.name === 'TypeError') {
      // Network error
      throw new Error('–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.');
    }
    throw error;
  }
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ JSON –æ—à–∏–±–æ–∫ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

```javascript
async function fetchData(url) {
  const response = await fetch(url);

  if (!response.ok) {
    // –°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å JSON —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏
    const errorData = await response.json();
    throw new Error(errorData.message || `HTTP ${response.status}`);
  }

  return await response.json();
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
try {
  const data = await fetchData('https://api.example.com/data');
} catch (error) {
  console.error('–û—à–∏–±–∫–∞:', error.message);
}
```

---

## üìñ Timeout –∏ AbortController

### Timeout –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤

```javascript
async function fetchWithTimeout(url, timeout = 5000) {
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), timeout);

  try {
    const response = await fetch(url, {
      signal: controller.signal
    });
    clearTimeout(timeoutId);
    return await response.json();
  } catch (error) {
    if (error.name === 'AbortError') {
      throw new Error('–ó–∞–ø—Ä–æ—Å –ø—Ä–µ–≤—ã—Å–∏–ª –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è');
    }
    throw error;
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
try {
  const data = await fetchWithTimeout('https://api.example.com/data', 3000);
} catch (error) {
  console.error(error.message);
}
```

### –û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞

```javascript
const controller = new AbortController();

// –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø—Ä–æ—Å
fetch('https://api.example.com/data', {
  signal: controller.signal
})
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => {
    if (error.name === 'AbortError') {
      console.log('–ó–∞–ø—Ä–æ—Å –æ—Ç–º–µ–Ω—ë–Ω');
    }
  });

// –û—Ç–º–µ–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —É—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
controller.abort();
```

---

## üìñ CORS (Cross-Origin Resource Sharing)

### –ß—Ç–æ —Ç–∞–∫–æ–µ CORS

**CORS** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –∑–∞–ø—Ä–æ—Å—ã –∫ –¥—Ä—É–≥–∏–º –¥–æ–º–µ–Ω–∞–º.

```javascript
// –í–∞—à —Å–∞–π—Ç: https://mysite.com
// API: https://api.example.com

// –ú–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑-–∑–∞ CORS!
fetch('https://api.example.com/data')
  .then(response => response.json())
  .catch(error => console.error('CORS error:', error));
```

**–û—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```
Access to fetch at 'https://api.example.com/data' from origin
'https://mysite.com' has been blocked by CORS policy
```

### –†–µ—à–µ–Ω–∏—è CORS

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (–ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç):
```javascript
// –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏:
Access-Control-Allow-Origin: https://mysite.com
// –∏–ª–∏
Access-Control-Allow-Origin: *
```

2. **CORS Proxy** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):
```javascript
const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
const targetUrl = 'https://api.example.com/data';

fetch(proxyUrl + targetUrl)
  .then(response => response.json());
```

3. **JSONP** (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥):
```javascript
// –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤
// –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
```

4. **Backend Proxy**:
```javascript
// –î–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä
// –§—Ä–æ–Ω—Ç–µ–Ω–¥ -> –í–∞—à —Å–µ—Ä–≤–µ—Ä -> –í–Ω–µ—à–Ω–µ–µ API
fetch('https://mysite.com/api/proxy?url=https://api.example.com/data')
```

---

## üå§Ô∏è –ü—Ä–∞–∫—Ç–∏–∫–∞: –ü–æ–≥–æ–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ó–∞–¥–∞–Ω–∏–µ 2.2.3.1: –û–±—ë—Ä—Ç–∫–∞ –¥–ª—è Fetch API

–°–æ–∑–¥–∞–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API.

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏—é `apiRequest`, –∫–æ—Ç–æ—Ä–∞—è:
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ HTTP –º–µ—Ç–æ–¥—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç timeout

**–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–æ–¥:**

```javascript
/**
 * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
 * TODO: –†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
 * - HTTP –º–µ—Ç–æ–¥–æ–≤ (GET, POST, PUT, DELETE)
 * - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
 * - Timeout —á–µ—Ä–µ–∑ AbortController
 * - –û–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (—Å–µ—Ç—å + HTTP —Å—Ç–∞—Ç—É—Å—ã)
 */
async function apiRequest(url, options = {}) {
  // –¢–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
  // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ options: { method, body, headers, timeout }
}

// TODO: –°–æ–∑–¥–∞–π —É–¥–æ–±–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã
// const api = {
//   get: (url, options) => apiRequest(url, { ...options, method: 'GET' }),
//   post: (url, body, options) => apiRequest(url, { ...options, method: 'POST', body }),
//   put: (url, body, options) => apiRequest(url, { ...options, method: 'PUT', body }),
//   delete: (url, options) => apiRequest(url, { ...options, method: 'DELETE' })
// };

// –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º —Ç–µ—Å—Ç–æ–≤—ã–º API (JSONPlaceholder):

// GET –∑–∞–ø—Ä–æ—Å - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
// const users = await apiRequest('https://jsonplaceholder.typicode.com/users');
// console.log(users);

// GET –∑–∞–ø—Ä–æ—Å - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// const user = await apiRequest('https://jsonplaceholder.typicode.com/users/1');
// console.log(user);

// POST –∑–∞–ø—Ä–æ—Å - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// const newUser = await apiRequest('https://jsonplaceholder.typicode.com/users', {
//   method: 'POST',
//   body: { name: 'John Doe', email: 'john@example.com' }
// });
// console.log(newUser);

// PUT –∑–∞–ø—Ä–æ—Å - –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// const updated = await apiRequest('https://jsonplaceholder.typicode.com/users/1', {
//   method: 'PUT',
//   body: { name: 'Jane Doe', email: 'jane@example.com' }
// });

// DELETE –∑–∞–ø—Ä–æ—Å - —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// await apiRequest('https://jsonplaceholder.typicode.com/users/1', {
//   method: 'DELETE'
// });

// –° timeout - –ø—Ä–µ—Ä–≤–∞—Ç—å –µ—Å–ª–∏ –¥–æ–ª–≥–æ
// const data = await apiRequest('https://jsonplaceholder.typicode.com/posts', {
//   timeout: 3000
// });
```

**–¢–µ—Å—Ç–æ–≤—ã–π HTML –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç API Wrapper</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    button {
      margin: 10px 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #667eea;
      color: white;
    }
    button:hover {
      background: #5568d3;
    }
    #output {
      margin-top: 20px;
      padding: 20px;
      background: #f5f5f5;
      border-radius: 8px;
      white-space: pre-wrap;
      font-family: monospace;
      max-height: 500px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>API Wrapper - –¢–µ—Å—Ç</h1>

  <div>
    <button onclick="testGet()">GET /users</button>
    <button onclick="testPost()">POST /users</button>
    <button onclick="testPut()">PUT /users/1</button>
    <button onclick="testDelete()">DELETE /users/1</button>
    <button onclick="testError()">Test 404 Error</button>
    <button onclick="testTimeout()">Test Timeout</button>
  </div>

  <div id="output">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</div>

  <script>
    // TODO: –î–æ–±–∞–≤—å —Ñ—É–Ω–∫—Ü–∏—é apiRequest –∑–¥–µ—Å—å
    // async function apiRequest(url, options = {}) { ... }

    window.log = (message) => {
      const output = document.getElementById('output');
      output.textContent = typeof message === 'object'
        ? JSON.stringify(message, null, 2)
        : message;
    };

    window.testGet = async () => {
      try {
        log('–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...');
        const users = await apiRequest('https://jsonplaceholder.typicode.com/users');
        log(users);
      } catch (error) {
        log('–û—à–∏–±–∫–∞: ' + error.message);
      }
    };

    window.testPost = async () => {
      try {
        log('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
        const newUser = await apiRequest('https://jsonplaceholder.typicode.com/users', {
          method: 'POST',
          body: {
            name: 'John Doe',
            email: 'john@example.com',
            username: 'johndoe'
          }
        });
        log(newUser);
      } catch (error) {
        log('–û—à–∏–±–∫–∞: ' + error.message);
      }
    };

    window.testPut = async () => {
      try {
        log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
        const updated = await apiRequest('https://jsonplaceholder.typicode.com/users/1', {
          method: 'PUT',
          body: {
            name: 'Jane Smith',
            email: 'jane@example.com'
          }
        });
        log(updated);
      } catch (error) {
        log('–û—à–∏–±–∫–∞: ' + error.message);
      }
    };

    window.testDelete = async () => {
      try {
        log('–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
        await apiRequest('https://jsonplaceholder.typicode.com/users/1', {
          method: 'DELETE'
        });
        log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω');
      } catch (error) {
        log('–û—à–∏–±–∫–∞: ' + error.message);
      }
    };

    window.testError = async () => {
      try {
        log('–ó–∞–ø—Ä–æ—Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ä–µ—Å—É—Ä—Å–∞...');
        await apiRequest('https://jsonplaceholder.typicode.com/users/999999');
      } catch (error) {
        log('–û—à–∏–±–∫–∞ (–æ–∂–∏–¥–∞–µ–º–æ): ' + error.message);
      }
    };

    window.testTimeout = async () => {
      try {
        log('–¢–µ—Å—Ç timeout (1ms)...');
        await apiRequest('https://jsonplaceholder.typicode.com/users', {
          timeout: 1
        });
      } catch (error) {
        log('–û—à–∏–±–∫–∞ timeout (–æ–∂–∏–¥–∞–µ–º–æ): ' + error.message);
      }
    };
  </script>
</body>
</html>
```

<details>
<summary>üí° –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
/**
 * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
 */
async function apiRequest(url, options = {}) {
  const {
    method = 'GET',
    body = null,
    headers = {},
    timeout = 10000
  } = options;

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ fetch
  const fetchOptions = {
    method,
    headers: {
      'Content-Type': 'application/json',
      ...headers
    }
  };

  // –î–æ–±–∞–≤–ª—è–µ–º body –¥–ª—è POST/PUT/PATCH
  if (body && ['POST', 'PUT', 'PATCH'].includes(method)) {
    fetchOptions.body = JSON.stringify(body);
  }

  // Timeout —á–µ—Ä–µ–∑ AbortController
  const controller = new AbortController();
  fetchOptions.signal = controller.signal;

  const timeoutId = setTimeout(() => controller.abort(), timeout);

  try {
    const response = await fetch(url, fetchOptions);
    clearTimeout(timeoutId);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –æ—à–∏–±–æ–∫
    if (!response.ok) {
      let errorMessage = `HTTP ${response.status}: ${response.statusText}`;

      // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
      try {
        const errorData = await response.json();
        errorMessage = errorData.message || errorMessage;
      } catch (e) {
        // –°–µ—Ä–≤–µ—Ä –Ω–µ –≤–µ—Ä–Ω—É–ª JSON
      }

      throw new Error(errorMessage);
    }

    // –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç
    const contentType = response.headers.get('content-type');
    if (contentType && contentType.includes('application/json')) {
      return await response.json();
    } else {
      return await response.text();
    }

  } catch (error) {
    clearTimeout(timeoutId);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
    if (error.name === 'AbortError') {
      throw new Error('–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞');
    } else if (error.name === 'TypeError') {
      throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É');
    } else {
      throw error;
    }
  }
}

// –£–¥–æ–±–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã
const api = {
  get: (url, options) => apiRequest(url, { ...options, method: 'GET' }),
  post: (url, body, options) => apiRequest(url, { ...options, method: 'POST', body }),
  put: (url, body, options) => apiRequest(url, { ...options, method: 'PUT', body }),
  delete: (url, options) => apiRequest(url, { ...options, method: 'DELETE' })
};
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å JSONPlaceholder API:**

```javascript

// GET –∑–∞–ø—Ä–æ—Å - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
try {
  const users = await api.get('https://jsonplaceholder.typicode.com/users');
  console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', users.length);
  console.log('–ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', users[0]);
} catch (error) {
  console.error('–û—à–∏–±–∫–∞:', error.message);
}

// GET –∑–∞–ø—Ä–æ—Å - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
try {
  const user = await api.get('https://jsonplaceholder.typicode.com/users/1');
  console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', user.name);
} catch (error) {
  console.error('–û—à–∏–±–∫–∞:', error.message);
}

// POST –∑–∞–ø—Ä–æ—Å - —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
try {
  const newUser = await api.post('https://jsonplaceholder.typicode.com/users', {
    name: 'John Doe',
    email: 'john@example.com',
    username: 'johndoe'
  });
  console.log('–°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID:', newUser.id);
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è:', error.message);
}

// PUT –∑–∞–ø—Ä–æ—Å - –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
try {
  const updated = await api.put('https://jsonplaceholder.typicode.com/users/1', {
    name: 'Jane Smith',
    email: 'jane@example.com'
  });
  console.log('–û–±–Ω–æ–≤–ª—ë–Ω:', updated);
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error.message);
}

// DELETE –∑–∞–ø—Ä–æ—Å - —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
try {
  await api.delete('https://jsonplaceholder.typicode.com/users/1');
  console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω');
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error.message);
}

// –° timeout
try {
  const posts = await apiRequest('https://jsonplaceholder.typicode.com/posts', {
    timeout: 5000
  });
  console.log('–ü–æ—Å—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–æ:', posts.length);
} catch (error) {
  console.error('–û—à–∏–±–∫–∞:', error.message);
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ 404
try {
  await api.get('https://jsonplaceholder.typicode.com/users/999999');
} catch (error) {
  console.error('–†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω:', error.message); // HTTP 404
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** JSONPlaceholder ‚Äî —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π fake REST API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –Ω–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (POST/PUT/DELETE —Ç–æ–ª—å–∫–æ —ç–º—É–ª–∏—Ä—É—é—Ç—Å—è).

</details>

---

### –ó–∞–¥–∞–Ω–∏–µ 2.2.3.2: –ü–æ–≥–æ–¥–Ω–æ–µ API —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

–°–æ–∑–¥–∞–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenWeatherMap API —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–ó–∞–¥–∞—á–∞:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ 10 –º–∏–Ω—É—Ç
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏ –∏ API

**–°—Ç–∞—Ä—Ç–æ–≤—ã–π HTML:**

```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–≥–æ–¥–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
    }
    .weather-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .search {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    input {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 4px;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      background: white;
      color: #667eea;
      font-weight: bold;
      cursor: pointer;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .weather-info {
      font-size: 18px;
    }
    .temp {
      font-size: 48px;
      font-weight: bold;
    }
    .cache-info {
      font-size: 12px;
      opacity: 0.8;
      margin-top: 10px;
    }
    .error {
      background: #f44336;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="weather-card">
    <h1>üå§Ô∏è –ü–æ–≥–æ–¥–∞ —Å –∫—ç—à–µ–º</h1>

    <div class="search">
      <input type="text" id="cityInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥...">
      <button id="searchBtn">–ü–æ–∏—Å–∫</button>
    </div>

    <div id="weatherInfo" class="weather-info"></div>
    <div id="cacheInfo" class="cache-info"></div>
  </div>

  <script type="module">
    // TODO: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π apiRequest
    // import apiRequest from './api-wrapper.js';

    const API_KEY = '—Ç–≤–æ–π_api_–∫–ª—é—á'; // https://openweathermap.org/api
    const API_URL = 'https://api.openweathermap.org/data/2.5/weather';

    // TODO: –†–µ–∞–ª–∏–∑—É–π –∫—ç—à
    // - –•—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Map –∏–ª–∏ –æ–±—ä–µ–∫—Ç–µ
    // - –ö–ª—é—á: –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
    // - –ó–Ω–∞—á–µ–Ω–∏–µ: { data, timestamp }
    // - –°—Ä–æ–∫ –∂–∏–∑–Ω–∏: 10 –º–∏–Ω—É—Ç

    // TODO: –†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é getWeather(city)
    // - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
    // - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å, –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ –∏–ª–∏ —Å–≤–µ–∂–∏–µ
    // - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏

    // TODO: –†–µ–∞–ª–∏–∑—É–π UI —Ñ—É–Ω–∫—Ü–∏–∏
    // - showLoading()
    // - showWeather(data, fromCache)
    // - showError(message)

    document.getElementById('searchBtn').addEventListener('click', async () => {
      const city = document.getElementById('cityInput').value.trim();
      if (!city) return;

      // –¢–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
    });
  </script>
</body>
</html>
```

<details>
<summary>üí° –†–µ—à–µ–Ω–∏–µ</summary>

```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–≥–æ–¥–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .weather-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .search {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    input {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 4px;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      background: white;
      color: #667eea;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }
    button:hover:not(:disabled) {
      transform: scale(1.05);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .weather-info {
      font-size: 18px;
    }
    .temp {
      font-size: 48px;
      font-weight: bold;
      margin: 10px 0;
    }
    .cache-info {
      font-size: 12px;
      opacity: 0.8;
      margin-top: 15px;
      padding: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
    }
    .error {
      background: #f44336;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="weather-card">
    <h1>üå§Ô∏è –ü–æ–≥–æ–¥–∞ —Å –∫—ç—à–µ–º</h1>

    <div class="search">
      <input type="text" id="cityInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ (Moscow, London...)">
      <button id="searchBtn">–ü–æ–∏—Å–∫</button>
    </div>

    <div id="weatherInfo" class="weather-info"></div>
    <div id="cacheInfo" class="cache-info"></div>
  </div>

  <script>
    const API_KEY = '—Ç–≤–æ–π_api_–∫–ª—é—á'; // https://openweathermap.org/api
    const API_URL = 'https://api.openweathermap.org/data/2.5/weather';
    const CACHE_DURATION = 10 * 60 * 1000; // 10 –º–∏–Ω—É—Ç

    // –ö—ç—à –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
    const cache = new Map();

    // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
    async function apiRequest(url, options = {}) {
      const { timeout = 10000 } = options;

      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), timeout);

      try {
        const response = await fetch(url, {
          ...options,
          signal: controller.signal
        });

        clearTimeout(timeoutId);

        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω');
          } else if (response.status === 401) {
            throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á');
          } else {
            throw new Error(`HTTP ${response.status}`);
          }
        }

        return await response.json();
      } catch (error) {
        clearTimeout(timeoutId);

        if (error.name === 'AbortError') {
          throw new Error('–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è');
        } else if (error.name === 'TypeError') {
          throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ');
        }
        throw error;
      }
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    async function getWeather(city) {
      const cacheKey = city.toLowerCase();

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
      if (cache.has(cacheKey)) {
        const cached = cache.get(cacheKey);
        const age = Date.now() - cached.timestamp;

        // –ï—Å–ª–∏ –∫—ç—à —Å–≤–µ–∂–∏–π (< 10 –º–∏–Ω—É—Ç)
        if (age < CACHE_DURATION) {
          console.log(`–î–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ (${Math.round(age / 1000)}—Å –Ω–∞–∑–∞–¥)`);
          return {
            data: cached.data,
            fromCache: true,
            cacheAge: age
          };
        }

        // –ö—ç—à —É—Å—Ç–∞—Ä–µ–ª - —É–¥–∞–ª—è–µ–º
        cache.delete(cacheKey);
      }

      // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API
      const url = `${API_URL}?q=${city}&appid=${API_KEY}&units=metric&lang=ru`;
      const data = await apiRequest(url, { timeout: 5000 });

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
      cache.set(cacheKey, {
        data,
        timestamp: Date.now()
      });

      console.log('–°–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç API');
      return {
        data,
        fromCache: false
      };
    }

    // UI —Ñ—É–Ω–∫—Ü–∏–∏
    function showLoading() {
      const btn = document.getElementById('searchBtn');
      btn.disabled = true;
      btn.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';

      document.getElementById('weatherInfo').innerHTML = '<p>‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>';
      document.getElementById('cacheInfo').textContent = '';
    }

    function showWeather(data, fromCache, cacheAge) {
      const { name, sys, main, weather, wind } = data;

      document.getElementById('weatherInfo').innerHTML = `
        <h2>${name}, ${sys.country}</h2>
        <div class="temp">${Math.round(main.temp)}¬∞C</div>
        <p>${weather[0].description}</p>
        <p>–û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫: ${Math.round(main.feels_like)}¬∞C</p>
        <p>–í–ª–∞–∂–Ω–æ—Å—Ç—å: ${main.humidity}%</p>
        <p>–í–µ—Ç–µ—Ä: ${wind.speed} –º/—Å</p>
      `;

      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—ç—à–µ
      if (fromCache) {
        const seconds = Math.round(cacheAge / 1000);
        const minutes = Math.floor(seconds / 60);
        const timeStr = minutes > 0
          ? `${minutes} –º–∏–Ω ${seconds % 60} —Å–µ–∫`
          : `${seconds} —Å–µ–∫`;

        document.getElementById('cacheInfo').innerHTML = `
          üíæ –î–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ (${timeStr} –Ω–∞–∑–∞–¥)
        `;
      } else {
        document.getElementById('cacheInfo').innerHTML = `
          üåê –°–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç API<br>
          –ë—É–¥—É—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ 10 –º–∏–Ω—É—Ç
        `;
      }
    }

    function showError(message) {
      document.getElementById('weatherInfo').innerHTML = `
        <div class="error">
          ‚ùå ${message}
        </div>
      `;
      document.getElementById('cacheInfo').textContent = '';
    }

    function resetButton() {
      const btn = document.getElementById('searchBtn');
      btn.disabled = false;
      btn.textContent = '–ü–æ–∏—Å–∫';
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
    document.getElementById('searchBtn').addEventListener('click', async () => {
      const city = document.getElementById('cityInput').value.trim();

      if (!city) {
        showError('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞');
        return;
      }

      showLoading();

      try {
        const { data, fromCache, cacheAge } = await getWeather(city);
        showWeather(data, fromCache, cacheAge);
      } catch (error) {
        showError(error.message);
      } finally {
        resetButton();
      }
    });

    // Enter –≤ input
    document.getElementById('cityInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('searchBtn').click();
      }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ú–æ—Å–∫–≤—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    document.getElementById('cityInput').value = 'Moscow';
    document.getElementById('searchBtn').click();
  </script>
</body>
</html>
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—ç—à:**
1. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ—Ç API –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Map
2. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–æ–∑—Ä–∞—Å—Ç –∫—ç—à–∞
3. –ï—Å–ª–∏ –∫—ç—à—É < 10 –º–∏–Ω—É—Ç ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞
4. –ï—Å–ª–∏ –∫—ç—à —É—Å—Ç–∞—Ä–µ–ª ‚Äî –¥–µ–ª–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

**–ü—Ä–æ–≤–µ—Ä—å:** –ù–∞–π–¥–∏ –ø–æ–≥–æ–¥—É –¥–ª—è –≥–æ—Ä–æ–¥–∞, –∑–∞—Ç–µ–º –Ω–∞–π–¥–∏ –µ–≥–æ —Å–Ω–æ–≤–∞ ‚Äî –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—ë—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ –∫—ç—à–∞!

</details>

---

### –ó–∞–¥–∞–Ω–∏–µ 2.2.3.3: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–ó–∞–≥—Ä—É–∑–∏ –ø–æ–≥–æ–¥—É –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

**–ó–∞–¥–∞—á–∞:** –ò—Å–ø–æ–ª—å–∑—É–π `Promise.all` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–≥–æ–¥—ã.

**–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–æ–¥:**

```javascript
const API_KEY = '—Ç–≤–æ–π_api_–∫–ª—é—á';
const API_URL = 'https://api.openweathermap.org/data/2.5/weather';

// TODO: –†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–≥–æ–¥—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
async function fetchCityWeather(city) {
  // –¢–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}

// TODO: –†–µ–∞–ª–∏–∑—É–π —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤
// –ò—Å–ø–æ–ª—å–∑—É–π Promise.all –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
async function fetchMultipleCities(cities) {
  // –¢–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const cities = ['Moscow', 'London', 'Paris', 'Tokyo', 'New York'];
// const results = await fetchMultipleCities(cities);
```

<details>
<summary>üí° –†–µ—à–µ–Ω–∏–µ</summary>

```javascript
const API_KEY = '—Ç–≤–æ–π_api_–∫–ª—é—á';
const API_URL = 'https://api.openweathermap.org/data/2.5/weather';

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≥–æ–¥—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
async function fetchCityWeather(city) {
  try {
    const url = `${API_URL}?q=${city}&appid=${API_KEY}&units=metric&lang=ru`;
    const response = await fetch(url);

    if (!response.ok) {
      throw new Error(`${city}: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω`);
    }

    const data = await response.json();

    return {
      success: true,
      city: data.name,
      temp: Math.round(data.main.temp),
      description: data.weather[0].description,
      icon: data.weather[0].icon
    };
  } catch (error) {
    return {
      success: false,
      city,
      error: error.message
    };
  }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
async function fetchMultipleCities(cities) {
  console.log(`–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≥–æ–¥—ã –¥–ª—è ${cities.length} –≥–æ—Ä–æ–¥–æ–≤...`);

  const startTime = Date.now();

  // Promise.all - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
  const results = await Promise.all(
    cities.map(city => fetchCityWeather(city))
  );

  const duration = Date.now() - startTime;
  console.log(`–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ ${duration}ms`);

  // –†–∞–∑–¥–µ–ª—è–µ–º —É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ
  const successful = results.filter(r => r.success);
  const failed = results.filter(r => !r.success);

  return {
    successful,
    failed,
    duration
  };
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
async function demo() {
  const cities = ['Moscow', 'London', 'Paris', 'Tokyo', 'New York'];

  const { successful, failed, duration } = await fetchMultipleCities(cities);

  console.log('\n‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ:', successful.length);
  successful.forEach(result => {
    console.log(`  ${result.city}: ${result.temp}¬∞C, ${result.description}`);
  });

  if (failed.length > 0) {
    console.log('\n‚ùå –û—à–∏–±–∫–∏:', failed.length);
    failed.forEach(result => {
      console.log(`  ${result.error}`);
    });
  }

  console.log(`\n‚è± –û–±—â–µ–µ –≤—Ä–µ–º—è: ${duration}ms`);
}

demo();
```

**–í–∞—Ä–∏–∞–Ω—Ç —Å Promise.allSettled (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ):**

```javascript
// Promise.allSettled - –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
async function fetchMultipleCitiesSafe(cities) {
  const results = await Promise.allSettled(
    cities.map(city => fetchCityWeather(city))
  );

  return results.map((result, i) => {
    if (result.status === 'fulfilled') {
      return result.value;
    } else {
      return {
        success: false,
        city: cities[i],
        error: result.reason.message
      };
    }
  });
}
```

**–†–∞–∑–Ω–∏—Ü–∞:**
- `Promise.all` ‚Äî –µ—Å–ª–∏ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —É–ø–∞–ª, –≤—Å—ë –ø–∞–¥–∞–µ—Ç
- `Promise.allSettled` ‚Äî –≤—Å–µ–≥–¥–∞ –∂–¥—ë—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏

</details>

---

## üèÜ –ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ 2.2.3

**–°–æ–∑–¥–∞–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –ø–æ–≥–æ–¥–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å –ø–æ–∏—Å–∫–æ–º, –∏–∑–±—Ä–∞–Ω–Ω—ã–º –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –≥–æ—Ä–æ–¥–æ–≤.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
   - –ü–æ–∏—Å–∫ –ø–æ–≥–æ–¥—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥–æ—Ä–æ–¥–∞
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ (localStorage)
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ—Ä–æ–¥–∞—Ö
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
   - –ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω
   - –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é
   - –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
   - Timeout –∑–∞–ø—Ä–æ—Å–æ–≤

3. **UI/UX:**
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—ç—à–µ
   - –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞
   - –ê–Ω–∏–º–∞—Ü–∏–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

–°–æ–∑–¥–∞–π –æ–¥–∏–Ω HTML —Ñ–∞–π–ª —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏ –∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏. –û—Ä–≥–∞–Ω–∏–∑—É–π –∫–æ–¥ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
weather-app.html
‚îú‚îÄ‚îÄ <style>         # –°—Ç–∏–ª–∏
‚îî‚îÄ‚îÄ <script>        # –í–µ—Å—å JavaScript –∫–æ–¥
    ‚îú‚îÄ‚îÄ API —Ñ—É–Ω–∫—Ü–∏–∏
    ‚îú‚îÄ‚îÄ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îú‚îÄ‚îÄ LocalStorage
    ‚îî‚îÄ‚îÄ UI —Ñ—É–Ω–∫—Ü–∏–∏
```

<details>
<summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ</summary>

### API —Ñ—É–Ω–∫—Ü–∏–∏
```javascript
// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è fetch
async function apiRequest(url, options = {}) {
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ –∑–∞–¥–∞–Ω–∏—è 2.2.3.1
}

// –ö—ç—à –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
const cache = new Map();
const CACHE_DURATION = 10 * 60 * 1000;

function getCached(key) {
  if (!cache.has(key)) return null;

  const { data, timestamp } = cache.get(key);
  const age = Date.now() - timestamp;

  if (age > CACHE_DURATION) {
    cache.delete(key);
    return null;
  }

  return { data, fromCache: true, age };
}

function setCache(key, data) {
  cache.set(key, { data, timestamp: Date.now() });
}
```

### –ü–æ–≥–æ–¥–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```javascript

const API_KEY = '—Ç–≤–æ–π_–∫–ª—é—á';
const API_URL = 'https://api.openweathermap.org/data/2.5/weather';

async function getWeatherByCity(city) {
  const cacheKey = `weather:${city.toLowerCase()}`;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
  const cached = getCached(cacheKey);
  if (cached) return cached;

  // –ó–∞–ø—Ä–æ—Å –∫ API
  const url = `${API_URL}?q=${city}&appid=${API_KEY}&units=metric&lang=ru`;
  const data = await apiRequest(url);

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à
  setCache(cacheKey, data);

  return { data, fromCache: false };
}

async function getWeatherByCoords(lat, lon) {
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
}

async function getWeatherForMultipleCities(cities) {
  return Promise.all(cities.map(city => getWeatherByCity(city)));
}
```

### LocalStorage —Ñ—É–Ω–∫—Ü–∏–∏
```javascript
const FAVORITES_KEY = 'weather_favorites';

function getFavorites() {
  const data = localStorage.getItem(FAVORITES_KEY);
  return data ? JSON.parse(data) : [];
}

function addFavorite(city) {
  const favorites = getFavorites();
  if (!favorites.includes(city)) {
    favorites.push(city);
    localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
  }
}

function removeFavorite(city) {
  let favorites = getFavorites();
  favorites = favorites.filter(c => c !== city);
  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
}

function isFavorite(city) {
  return getFavorites().includes(city);
}
```

### UI —Ñ—É–Ω–∫—Ü–∏–∏
```javascript
function renderWeatherCard(data, container) {
  // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø–æ–≥–æ–¥–æ–π
}

function showLoading(container) {
  container.innerHTML = '<div class="loading">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>';
}

function showError(container, message) {
  container.innerHTML = `<div class="error">‚ùå ${message}</div>`;
}

function renderFavorites(cities, onRemove) {
  // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
}

function renderComparison(cities, onClose) {
  // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤
}
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
async function init() {
  setupEventListeners();
  await loadFavorites();
  await loadDefaultCity();
}

function setupEventListeners() {
  // –ü–æ–∏—Å–∫
  document.getElementById('searchBtn').addEventListener('click', handleSearch);

  // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
  document.getElementById('geoBtn').addEventListener('click', handleGeoLocation);

  // –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
  document.getElementById('favBtn').addEventListener('click', handleFavoriteToggle);
}

init();
```

</details>

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–π —Ç–µ–º—ã —Ç—ã –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:

- [ ] –ü–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–µ API –∏ REST
- [ ] –î–µ–ª–∞—Ç—å GET, POST, PUT, DELETE –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ fetch
- [ ] –†–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ —Ç–µ–ª–æ–º –∑–∞–ø—Ä–æ—Å–∞
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ (—Å–µ—Ç—å + HTTP)
- [ ] –ü–∞—Ä—Å–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ—Ç–≤–µ—Ç–æ–≤ (JSON, —Ç–µ–∫—Å—Ç, blob)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AbortController –¥–ª—è timeout –∏ –æ—Ç–º–µ–Ω—ã
- [ ] –ü–æ–Ω–∏–º–∞—Ç—å CORS –∏ —Å–ø–æ—Å–æ–±—ã —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- [ ] –î–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Promise.all

---

## üîó –†–µ—Å—É—Ä—Å—ã

**–°—Ç–∞—Ç—å–∏:**
- [MDN: Fetch API](https://developer.mozilla.org/ru/docs/Web/API/Fetch_API)
- [MDN: Using Fetch](https://developer.mozilla.org/ru/docs/Web/API/Fetch_API/Using_Fetch)
- [JavaScript.info: Fetch](https://learn.javascript.ru/fetch)

**API –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏:**
- [OpenWeatherMap](https://openweathermap.org/api) ‚Äî –ø–æ–≥–æ–¥–∞
- [JSONPlaceholder](https://jsonplaceholder.typicode.com/) ‚Äî —Ñ–µ–π–∫–æ–≤—ã–π REST API –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- [Rick and Morty API](https://rickandmortyapi.com/) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π REST API
- [Pok√©API](https://pokeapi.co/) ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫–µ–º–æ–Ω–∞—Ö

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- [Postman](https://www.postman.com/) ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
- [HTTPie](https://httpie.io/) ‚Äî CLI –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- [Insomnia](https://insomnia.rest/) ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Postman

**–í–∏–¥–µ–æ:**
- [Fetch API ‚Äî –í–ª–∞–¥–∏–ª–µ–Ω –ú–∏–Ω–∏–Ω](https://www.youtube.com/watch?v=eKCD9djJQKc)
- [Working with APIs ‚Äî Web Dev Simplified](https://www.youtube.com/watch?v=cuEtnrL9-H0)

---

‚è± **–í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ**: 4-5 —á–∞—Å–æ–≤

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ç–µ–º–∞:** [2.2.2 –ü—Ä–æ—Ç–æ—Ç–∏–ø—ã –∏ –∫–ª–∞—Å—Å—ã](./2.2.2-–ü—Ä–æ—Ç–æ—Ç–∏–ø—ã-–∏-–∫–ª–∞—Å—Å—ã.md)

**–°–ª–µ–¥—É—é—â–∞—è —Ç–µ–º–∞:** [2.2.4 –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å: callbacks ‚Üí promises ‚Üí async/await](./2.2.4-–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å.md)
